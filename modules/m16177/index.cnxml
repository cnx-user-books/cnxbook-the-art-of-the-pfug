<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns:md="http://cnx.rice.edu/mdml" xmlns:bib="http://bibtexml.sf.net/">
  <title>Rice University VIGRE: The Network Wave Equation</title>
  <metadata><md:content-id>undefined</md:content-id><md:title/><md:uuid>b1062f6b-bd63-47b2-9bd7-b74048a3e732</md:uuid>
</metadata>
  <content>
    
    <figure id="uid1" orient="horizontal"><media id="idm13686000" alt=""><image src="../../media/fancy.png" mime-type="image/png" width="346"/><image for="pdf" src="../../media/fancy.eps" mime-type="application/postscript" print-width="1.65"/></media>
      <caption>A fundamental mode of a complex spiderweb.</caption>
    </figure>
    <para id="id2255584">The motion of vibrating strings (such as musical instrument strings or, in this case, spiderwebs) can be described by the one dimensional wave equation on an interval <m:math><m:mrow><m:mi>x</m:mi><m:mo>∈</m:mo><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mi>ℓ</m:mi><m:mo>]</m:mo></m:mrow></m:math>, with <m:math><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>,</m:mo><m:mi>ℓ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>, where <m:math><m:mi>u</m:mi></m:math> is the displacement of the string and <m:math><m:mi>ℓ</m:mi></m:math> is the strings length. The eigenvalues derived from this model progress in a well-known linear fashion, similar to the Western scale, leading to a pleasant sound when the string is plucked. A network of connected strings can be expressed in a similar manner; however, the progression of eigenvalues is much less regular and depends largely on the topology of the network. We examine these eigenvalues and their associated eigenvectors using a finite element discretization of such networks, then compare these results to closed form eigensolutions based on Joachim Von Below's examination of networks of strings in “A Characteristic Equation Associated to an Eigenvalue Problem on <m:math><m:msup><m:mi>c</m:mi><m:mn>2</m:mn></m:msup></m:math>-Networks", <emphasis>Linear Algebra and its Applications</emphasis>, Volume 71 (1985), p309-325.</para>
    <section id="uid2">
      <title>Introduction</title>
      <para id="id2255966">The purpose of the Physics of Strings seminar has traditionally been to study the motion of a vibrating string by analyzing its eigenfunctions and eigenvalues, equivalent to the string's fundamental modes and fundamental frequencies, respectively. The progression of these eigenvalues and eigenvectors tells us a great deal about the string; for example, given eigenvalues of a string, we can determine how quickly its vibrations decay, and whether the frequency of a vibration affects how quickly it's damped.</para>
      <para id="id2255978">The properties of the string, likewise, can tell us something about the eigenvalues. Physical constants, such as the length of the string, are proportionally related to the eigenvalues. Given data on the vibration of a string, there are also methods for reverse-engineering the eigenvalues of that string. There are several models of a vibrating string, and the most detailed ones can reproduce eigenvalues that accurately match the reverse-engineered string eigenvalues. However, while much research has been done on several models of a single string, the behavior of networks of strings is less well understood.</para>
      <para id="id2255991">We seek to mathematically model and investigate the motion of networks of strings, specifically by understanding eigenvalues and the corresponding modes of vibration. We study these behaviors within the context of the tritar (a guitar-like instrument based upon a Y-shaped network of 3 strings) and in the vibrations of more complex networks such as spiderwebs.</para>
      <section id="uid3">
        <title>The wave equation</title>
        <para id="id2256007">The vibration of a string in one dimension can be understood through the standard wave equation, given by</para>
        <equation id="id2256012">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>u</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msup>
                    <m:mi>t</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>c</m:mi>
                <m:mn>2</m:mn>
              </m:msup>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>u</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msup>
                    <m:mi>x</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
              <m:mo>,</m:mo>
              <m:mspace width="2.em"/>
              <m:mi>u</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mi>u</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>ℓ</m:mi>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mn>0</m:mn>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2256119">where <m:math><m:mi>u</m:mi></m:math> describes string displacement, <m:math><m:mi>c</m:mi></m:math> is a constant describing wave speed and <m:math><m:mi>ℓ</m:mi></m:math> is the length of the string. The string is fixed at displacement 0 at the endpoints and assume without loss of generality <m:math><m:mrow><m:mi>c</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>. This equation is derived in much more detail in <link target-id="bid0"/>. This second order partial differential equation can likewise be rewritten as a system of two ordinary differential equations in time</para>
        <equation id="id2256175">
          <m:math mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mfrac>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:mi>u</m:mi>
                    </m:mrow>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:mi>t</m:mi>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>v</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mfrac>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:mi>v</m:mi>
                    </m:mrow>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:mi>t</m:mi>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msup>
                      <m:mi>c</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:mfrac>
                      <m:mrow>
                        <m:msup>
                          <m:mi>∂</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                        <m:mi>u</m:mi>
                      </m:mrow>
                      <m:mrow>
                        <m:mi>∂</m:mi>
                        <m:msup>
                          <m:mi>x</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                      </m:mrow>
                    </m:mfrac>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id2256270">or equivalently, the first order matrix equation</para>
        <equation id="id2256276">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mi>∂</m:mi>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:mfrac>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>u</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>v</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mi>I</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mrow>
                        <m:msup>
                          <m:mi>c</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                        <m:mfrac>
                          <m:msup>
                            <m:mi>∂</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                          <m:mrow>
                            <m:mi>∂</m:mi>
                            <m:msup>
                              <m:mi>x</m:mi>
                              <m:mn>2</m:mn>
                            </m:msup>
                          </m:mrow>
                        </m:mfrac>
                      </m:mrow>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>u</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>v</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
      </section>
      <section id="uid4">
        <title>Eigenvalues, eigenfunctions, and their significance</title>
        <para id="id2256388">We are especially interested in the eigenvalues <m:math><m:mi>λ</m:mi></m:math> and associated eigenfunctions of the wave equation, such that</para>
        <equation id="id2256402">
          <m:math mode="display">
            <m:mrow>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mi>I</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mfrac>
                        <m:msup>
                          <m:mi>∂</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msup>
                            <m:mi>x</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                        </m:mrow>
                      </m:mfrac>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>u</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>v</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>=</m:mo>
              <m:mi>λ</m:mi>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>u</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>v</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="2.em"/>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>u</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msup>
                    <m:mi>x</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>λ</m:mi>
                <m:mn>2</m:mn>
              </m:msup>
              <m:mi>u</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2256531">Since only trigonometric functions satisfy both our equation and our boundary conditions, our eigenfunctions take the form <m:math><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>A</m:mi><m:mo form="prefix">sin</m:mo><m:mo>(</m:mo><m:mi>λ</m:mi><m:mi>x</m:mi><m:mo>)</m:mo><m:mo>+</m:mo><m:mi>B</m:mi><m:mo form="prefix">cos</m:mo><m:mo>(</m:mo><m:mi>λ</m:mi><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math>. Applying our boundary condition at <m:math><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math> to <m:math><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> reveals that <m:math><m:mrow><m:mi>B</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>. Since we can then set <m:math><m:mi>A</m:mi></m:math> as an arbitrary scaling factor, our eigenfunction <m:math><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> is simply <m:math><m:mrow><m:mo form="prefix">sin</m:mo><m:mfenced separators="" open="(" close=")"><m:mi>λ</m:mi><m:mi>x</m:mi></m:mfenced></m:mrow></m:math>. By applying our second boundary condition at <m:math><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:mi>ℓ</m:mi></m:mrow></m:math>, we can see that <m:math><m:mi>λ</m:mi></m:math> is of the form <m:math><m:mfrac><m:mrow><m:mi>i</m:mi><m:mi>π</m:mi><m:mi>n</m:mi></m:mrow><m:mi>ℓ</m:mi></m:mfrac></m:math> for any nonzero integer <m:math><m:mi>n</m:mi></m:math>. We then get the eigenpairs</para>
        <equation id="id2256731">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>λ</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mfrac>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mi>π</m:mi>
                  <m:mi>n</m:mi>
                </m:mrow>
                <m:mi>ℓ</m:mi>
              </m:mfrac>
              <m:mo>,</m:mo>
              <m:mspace width="2.em"/>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mi>n</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mo form="prefix">sin</m:mo>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>λ</m:mi>
                  <m:mi>n</m:mi>
                </m:msub>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2256803">These eigenfunctions constitute an infinite-dimensional basis for any solution to the wave equation, with <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> orthogonal to <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for <m:math><m:mrow><m:mi>i</m:mi><m:mo>≠</m:mo><m:mi>j</m:mi></m:mrow></m:math> with respect to the inner product</para>
        <equation id="id2256870">
          <m:math mode="display">
            <m:mrow>
              <m:mrow>
                <m:mo>〈</m:mo>
                <m:msub>
                  <m:mi>u</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>u</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mo>〉</m:mo>
              </m:mrow>
              <m:mo>≡</m:mo>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2256961">Intuitively, these correspond to the fundamental modes of a string - any vibration of the string can be decomposed into a linear combination of the fundamentals. The magnitude of each eigenvalue, likewise, is related to the frequency at which the corresponding fundamental mode vibrates - in other words, each eigenvalue is tied to a note in the progression of the Western scale. As we will see, this linear progression of the eigenvalues is lost when a single string is replaced by a network of strings, leading to more of a dissonant sound when a network is plucked.</para>
      </section>
      <section id="uid5">
        <title>Finite element solution method</title>
        <para id="id2256983">In this report, we use the finite element method to numerically solve for solutions to the wave equation. The idea behind this method is based on picking a finite-dimensional set of <m:math><m:mi>N</m:mi></m:math> basis functions <m:math><m:mrow><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> that span the space on which the solution is defined. We then calculate the best approximation</para>
        <equation id="id2257023">
          <m:math mode="display">
            <m:mrow>
              <m:mrow>
                <m:mi>u</m:mi>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>N</m:mi>
              </m:munderover>
              <m:msub>
                <m:mi>c</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msub>
                <m:mi>φ</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2257094">to the solution from the span of these basis functions via the solution to a matrix equation <m:math><m:mrow><m:mi>A</m:mi><m:mi>c</m:mi><m:mo>=</m:mo><m:mi>f</m:mi></m:mrow></m:math>. Recall the definition of our inner product <m:math><m:mrow><m:mrow><m:mo>〈</m:mo><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>u</m:mi><m:mi>j</m:mi></m:msub><m:mo>〉</m:mo></m:mrow><m:mo>≡</m:mo><m:msubsup><m:mo>∫</m:mo><m:mn>0</m:mn><m:mi>ℓ</m:mi></m:msubsup><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>u</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:mspace width="0.166667em"/><m:mi>d</m:mi><m:mi>x</m:mi></m:mrow></m:math>. Then, <m:math><m:mi>A</m:mi></m:math> is</para>
        <equation id="id2257215">
          <m:math mode="display">
            <m:mrow>
              <m:mi>A</m:mi>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>...</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>N</m:mi>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>...</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>N</m:mi>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mo>⋮</m:mo>
                    </m:mtd>
                    <m:mtd/>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                    <m:mtd/>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>N</m:mi>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>n</m:mi>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>...</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>n</m:mi>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>N</m:mi>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="2.em"/>
              <m:mi>f</m:mi>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:mi>f</m:mi>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:mi>f</m:mi>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mo>⋮</m:mo>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mfenced separators="" open="〈" close="〉">
                        <m:mi>f</m:mi>
                        <m:mo>,</m:mo>
                        <m:msub>
                          <m:mi>φ</m:mi>
                          <m:mi>N</m:mi>
                        </m:msub>
                      </m:mfenced>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2257574"><m:math><m:mi>A</m:mi></m:math> is called the Gramian matrix - a matrix whose <m:math><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:math>th entry is the inner product between the <m:math><m:mi>i</m:mi></m:math> and <m:math><m:mi>j</m:mi></m:math>th basis functions. After solving for the vector <m:math><m:mrow><m:mi>c</m:mi><m:mo>=</m:mo><m:msup><m:mrow><m:mo>[</m:mo><m:msub><m:mi>c</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>c</m:mi><m:mn>2</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>c</m:mi><m:mi>N</m:mi></m:msub><m:mo>]</m:mo></m:mrow><m:mi>T</m:mi></m:msup></m:mrow></m:math>, we can reconstruct our best approximation to the solution.</para>
        <para id="id2257675">We first rearrange our PDE into a more flexible form. Given a function <m:math><m:mrow><m:mi>v</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> obeying the same boundary conditions as <m:math><m:mi>u</m:mi></m:math>, multiply both sides of our wave equation by this function and integrate over the interval <m:math><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mi>ℓ</m:mi><m:mo>]</m:mo></m:mrow></m:math></para>
        <equation id="id2257725">
          <m:math mode="display">
            <m:mrow>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:msub>
              <m:mi>v</m:mi>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
              <m:mo>=</m:mo>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mrow>
                  <m:mi>x</m:mi>
                  <m:mi>x</m:mi>
                </m:mrow>
              </m:msub>
              <m:mi>v</m:mi>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2257800">If we integrate the right hand side by parts and apply Dirichlet boundary conditions, we get</para>
        <equation id="id2257808">
          <m:math mode="display">
            <m:mrow>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:msub>
              <m:mi>v</m:mi>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
              <m:mo>=</m:mo>
              <m:mo>-</m:mo>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mi>x</m:mi>
              </m:msub>
              <m:msub>
                <m:mi>v</m:mi>
                <m:mi>x</m:mi>
              </m:msub>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2257887">This form of the wave equation is called the equation's “weak form". Notice there is only one derivative with respect to <m:math><m:mi>x</m:mi></m:math> on <m:math><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math> now. We now expand <m:math><m:mrow><m:mi>u</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:math> in the space spanned by our basis functions</para>
        <equation id="id2257949">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mi>N</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>N</m:mi>
              </m:munderover>
              <m:msub>
                <m:mi>c</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msub>
                <m:mi>φ</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2258026">Let <m:math><m:mrow><m:mi>v</m:mi><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for <m:math><m:mrow><m:mi>i</m:mi><m:mo>∈</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>N</m:mi><m:mo>}</m:mo></m:mrow></m:math>. Plugging this into the wave equation's weak form, we get the relation</para>
        <equation id="id2258100">
          <m:math mode="display">
            <m:mrow>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>N</m:mi>
              </m:munderover>
              <m:msubsup>
                <m:mi>c</m:mi>
                <m:mi>j</m:mi>
                <m:mrow>
                  <m:mo>'</m:mo>
                  <m:mo>'</m:mo>
                </m:mrow>
              </m:msubsup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msub>
                <m:mi>φ</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msub>
                <m:mi>φ</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
              <m:mo>=</m:mo>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>N</m:mi>
              </m:munderover>
              <m:msub>
                <m:mi>c</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msubsup>
                <m:mo>∫</m:mo>
                <m:mn>0</m:mn>
                <m:mi>ℓ</m:mi>
              </m:msubsup>
              <m:msubsup>
                <m:mi>φ</m:mi>
                <m:mi>i</m:mi>
                <m:mo>'</m:mo>
              </m:msubsup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:msubsup>
                <m:mi>φ</m:mi>
                <m:mi>j</m:mi>
                <m:mo>'</m:mo>
              </m:msubsup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mspace width="0.166667em"/>
              <m:mi>d</m:mi>
              <m:mi>x</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2258287">Note that if we define a new “energy" inner product <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi></m:mfenced><m:mo>≡</m:mo><m:mfenced separators="" open="〈" close="〉"><m:msub><m:mi>u</m:mi><m:mi>x</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>v</m:mi><m:mi>x</m:mi></m:msub></m:mfenced></m:mrow></m:math>, we can then rewrite our whole relation as</para>
        <equation id="id2258345">
          <m:math mode="display">
            <m:mrow>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>N</m:mi>
              </m:munderover>
              <m:msubsup>
                <m:mi>c</m:mi>
                <m:mi>i</m:mi>
                <m:mrow>
                  <m:mo>'</m:mo>
                  <m:mo>'</m:mo>
                </m:mrow>
              </m:msubsup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mfenced separators="" open="〈" close="〉">
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
              </m:mfenced>
              <m:mo>=</m:mo>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>N</m:mi>
              </m:munderover>
              <m:msub>
                <m:mi>c</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mi>a</m:mi>
              <m:mfenced separators="" open="(" close=")">
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>,</m:mo>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2258479">for <m:math><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>N</m:mi></m:mrow></m:math>. Thus, we have <m:math><m:mi>N</m:mi></m:math> unknowns along with <m:math><m:mi>N</m:mi></m:math> linear equations; we can now formulate our problem as the matrix equation</para>
        <equation id="id2258532">
          <m:math mode="display">
            <m:mrow>
              <m:mi>M</m:mi>
              <m:msup>
                <m:mi>c</m:mi>
                <m:mrow>
                  <m:mo>'</m:mo>
                  <m:mo>'</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>=</m:mo>
              <m:mi>K</m:mi>
              <m:mi>c</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2258562">where <m:math><m:mi>M</m:mi></m:math> is the Gramian matrix created using regular inner products, and <m:math><m:mi>K</m:mi></m:math> is the Gramian matrix resulting from energy inner products.</para>
        <para id="id2258588">Using the finite element method, we choose our basis functions to be piecewise linear “hat" functions. If we partition the space <m:math><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mi>ℓ</m:mi><m:mo>]</m:mo></m:mrow></m:math> into <m:math><m:mi>n</m:mi></m:math> segments of the form <m:math><m:mrow><m:mo>[</m:mo><m:msub><m:mi>x</m:mi><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>x</m:mi><m:mi>k</m:mi></m:msub><m:mo>]</m:mo></m:mrow></m:math>, with <m:math><m:mrow><m:msub><m:mi>x</m:mi><m:mn>1</m:mn></m:msub><m:mo>&lt;</m:mo><m:msub><m:mi>x</m:mi><m:mn>2</m:mn></m:msub><m:mo>&lt;</m:mo><m:mo>...</m:mo><m:mo>&lt;</m:mo><m:msub><m:mi>x</m:mi><m:mi>N</m:mi></m:msub></m:mrow></m:math>, we can define these hat functions as</para>
        <equation id="id2258698">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>φ</m:mi>
                <m:mi>k</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>x</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="{" close="">
                <m:mtable>
                  <m:mtr>
                    <m:mtd columnalign="left">
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>x</m:mi>
                          <m:mo>-</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>k</m:mi>
                          </m:msub>
                          <m:mo>-</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                    </m:mtd>
                    <m:mtd columnalign="left">
                      <m:mrow>
                        <m:mspace width="1.em"/>
                        <m:mtext>if</m:mtext>
                        <m:mspace width="4.pt"/>
                        <m:mrow>
                          <m:mi>x</m:mi>
                          <m:mo>∈</m:mo>
                          <m:mo>[</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mo>,</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>k</m:mi>
                          </m:msub>
                          <m:mo>]</m:mo>
                        </m:mrow>
                        <m:mo>,</m:mo>
                      </m:mrow>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd columnalign="left">
                      <m:mfrac>
                        <m:mrow>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mo>+</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mo>-</m:mo>
                          <m:mi>x</m:mi>
                        </m:mrow>
                        <m:mrow>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mo>+</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mo>-</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>k</m:mi>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                    </m:mtd>
                    <m:mtd columnalign="left">
                      <m:mrow>
                        <m:mspace width="1.em"/>
                        <m:mtext>if</m:mtext>
                        <m:mspace width="4.pt"/>
                        <m:mrow>
                          <m:mi>x</m:mi>
                          <m:mo>∈</m:mo>
                          <m:mo>[</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mi>k</m:mi>
                          </m:msub>
                          <m:mo>,</m:mo>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mo>+</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mo>]</m:mo>
                        </m:mrow>
                        <m:mo>,</m:mo>
                      </m:mrow>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd columnalign="left">
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd columnalign="left">
                      <m:mrow>
                        <m:mspace width="1.em"/>
                        <m:mtext>otherwise</m:mtext>
                      </m:mrow>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2258943">for <m:math><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>N</m:mi></m:mrow></m:math>.</para>
        <figure id="uid6" orient="horizontal"><media id="idm482640" alt=""><image src="../../media/hat.png" mime-type="image/png" width="335"/><image for="pdf" src="../../media/hat.eps" mime-type="application/postscript" print-width=".3"/></media>
          <caption>A hat function centered at <m:math><m:mrow><m:mi>x</m:mi><m:mo>=</m:mo><m:mo>.</m:mo><m:mn>6</m:mn></m:mrow></m:math> with a step size <m:math><m:mrow><m:mi>h</m:mi><m:mo>=</m:mo><m:mo>.</m:mo><m:mn>2</m:mn></m:mrow></m:math>.</caption>
        </figure>
        <para id="id2259018">Since the support of <m:math><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub></m:math> and <m:math><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:math> overlap only if <m:math><m:mrow><m:mo>|</m:mo><m:mi>i</m:mi><m:mo>-</m:mo><m:mi>j</m:mi><m:mo>|</m:mo><m:mo>≤</m:mo><m:mn>1</m:mn></m:mrow></m:math>, most of the entries of <m:math><m:mi>M</m:mi></m:math> and <m:math><m:mi>K</m:mi></m:math> are automatically zero. For the rest of the terms, the inner products are easy to compute. If we take a uniform discretization of <m:math><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>]</m:mo></m:mrow></m:math> into these <m:math><m:mi>n</m:mi></m:math> segments, with <m:math><m:mrow><m:mi>h</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:mo>(</m:mo><m:mi>N</m:mi><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow></m:math> and <m:math><m:mrow><m:msub><m:mi>x</m:mi><m:mi>k</m:mi></m:msub><m:mo>=</m:mo><m:mi>k</m:mi><m:mi>h</m:mi></m:mrow></m:math>, then for <m:math><m:mrow><m:mo>|</m:mo><m:mi>i</m:mi><m:mo>-</m:mo><m:mi>j</m:mi><m:mo>|</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, <m:math><m:mrow><m:mfenced separators="" open="〈" close="〉"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub></m:mfenced><m:mo>=</m:mo><m:mn>2</m:mn><m:mi>h</m:mi><m:mo>/</m:mo><m:mn>3</m:mn></m:mrow></m:math>, <m:math><m:mrow><m:mfenced separators="" open="〈" close="〉"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced><m:mo>=</m:mo><m:mi>h</m:mi><m:mo>/</m:mo><m:mn>6</m:mn></m:mrow></m:math>, <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:mi>h</m:mi></m:mrow></m:math>, and <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub></m:mfenced><m:mo>=</m:mo><m:mo>-</m:mo><m:mn>2</m:mn><m:mo>/</m:mo><m:mi>h</m:mi></m:mrow></m:math>. <m:math><m:mi>M</m:mi></m:math> and <m:math><m:mi>K</m:mi></m:math> are just</para>
        <equation id="id2259387">
          <m:math mode="display">
            <m:mrow>
              <m:mi>M</m:mi>
              <m:mo>=</m:mo>
              <m:mfrac>
                <m:mi>h</m:mi>
                <m:mn>6</m:mn>
              </m:mfrac>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>4</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd/>
                    <m:mtd/>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>4</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd/>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd/>
                    <m:mtd/>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>4</m:mn>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="2.em"/>
              <m:mi>K</m:mi>
              <m:mo>=</m:mo>
              <m:mfrac>
                <m:mn>1</m:mn>
                <m:mi>h</m:mi>
              </m:mfrac>
              <m:mfenced separators="" open="[" close="">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:mn>2</m:mn>
                      </m:mrow>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd/>
                    <m:mtd/>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:mn>2</m:mn>
                      </m:mrow>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                    <m:mtd/>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd/>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mo>⋱</m:mo>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd/>
                    <m:mtd/>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:mn>2</m:mn>
                      </m:mrow>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2259536">We can solve for our coefficients <m:math><m:mi>c</m:mi></m:math> by rewriting <m:math><m:mrow><m:mi>M</m:mi><m:msup><m:mi>c</m:mi><m:mrow><m:mo>'</m:mo><m:mo>'</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mi>K</m:mi><m:mi>c</m:mi></m:mrow></m:math> as a system of equations</para>
        <equation id="id2259579">
          <m:math mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:msup>
                    <m:mi>c</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>d</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:msup>
                    <m:mi>d</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msup>
                      <m:mi>M</m:mi>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msup>
                    <m:mi>K</m:mi>
                    <m:mi>c</m:mi>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <equation id="id2259647">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mi>∂</m:mi>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:mfrac>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>c</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>d</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mi>I</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mrow>
                        <m:msup>
                          <m:mi>M</m:mi>
                          <m:mrow>
                            <m:mo>-</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                        </m:msup>
                        <m:mi>K</m:mi>
                      </m:mrow>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>c</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>d</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2259737">We can see the relation to the continuous system,</para>
        <equation id="id2259744">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mi>∂</m:mi>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:mfrac>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>u</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>v</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mi>I</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mfrac>
                        <m:msup>
                          <m:mi>∂</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msup>
                            <m:mi>x</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                        </m:mrow>
                      </m:mfrac>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>u</m:mi>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mi>v</m:mi>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2259841">where <m:math><m:mfrac><m:msup><m:mi>∂</m:mi><m:mn>2</m:mn></m:msup><m:mrow><m:mi>∂</m:mi><m:msup><m:mi>x</m:mi><m:mn>2</m:mn></m:msup></m:mrow></m:mfrac></m:math> is approximated by <m:math><m:mrow><m:msup><m:mi>M</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mi>K</m:mi></m:mrow></m:math>. With this discretization, we can numerically calculate the time solution of the wave equation given some initial condition, as well as approximate the eigenvalues <m:math><m:mi>λ</m:mi></m:math>.</para>
        <section id="uid7">
          <title>Damping</title>
          <para id="id2259914">A closely related equation is the wave equation with viscous damping (resulting from a viscous medium in which the string vibrates, i.e. air). To simulate this effect, a velocity-dependent damping function <m:math><m:mrow><m:mi>a</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> is added to the equation</para>
          <equation id="id2259938">
            <m:math mode="display">
              <m:mrow>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:mi>u</m:mi>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:mi>u</m:mi>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>x</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:mo>-</m:mo>
                <m:mn>2</m:mn>
                <m:mi>a</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:mi>u</m:mi>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:mi>t</m:mi>
                  </m:mrow>
                </m:mfrac>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2260024">For the cases we consider here, we shall take <m:math><m:mrow><m:mi>a</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>a</m:mi></m:mrow></m:math>, some constant.</para>
          <para id="id2260053">Thankfully, the finite element discretization of this equation doesn't involve much new work; all we do is reuse some of our calculations. If we make the substitution for <m:math><m:mi>u</m:mi></m:math></para>
          <equation id="id2260067">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>u</m:mi>
                  <m:mi>N</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2260132">we get</para>
          <equation id="id2260138">
            <m:math mode="display">
              <m:mrow>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msubsup>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                  <m:mrow>
                    <m:mo>'</m:mo>
                    <m:mo>'</m:mo>
                  </m:mrow>
                </m:msubsup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>=</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msubsup>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                  <m:mrow>
                    <m:mo>'</m:mo>
                    <m:mo>'</m:mo>
                  </m:mrow>
                </m:msubsup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>-</m:mo>
                <m:mn>2</m:mn>
                <m:mi>a</m:mi>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msubsup>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                  <m:mo>'</m:mo>
                </m:msubsup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2260313">Taking an inner product with <m:math><m:msub><m:mi>φ</m:mi><m:mi>k</m:mi></m:msub></m:math> for <m:math><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>N</m:mi></m:mrow></m:math> leads us to the following discretization</para>
          <equation id="id2260362">
            <m:math mode="display">
              <m:mrow>
                <m:mi>M</m:mi>
                <m:msup>
                  <m:mi>c</m:mi>
                  <m:mrow>
                    <m:mo>'</m:mo>
                    <m:mo>'</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>=</m:mo>
                <m:mi>K</m:mi>
                <m:mi>c</m:mi>
                <m:mo>-</m:mo>
                <m:mn>2</m:mn>
                <m:mi>a</m:mi>
                <m:mi>M</m:mi>
                <m:msup>
                  <m:mi>c</m:mi>
                  <m:mo>'</m:mo>
                </m:msup>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2260408">We usually refer to the matrix <m:math><m:mrow><m:mo>-</m:mo><m:mn>2</m:mn><m:mi>a</m:mi><m:mi>M</m:mi></m:mrow></m:math> as the damping matrix <m:math><m:mi>G</m:mi></m:math>. Again, we can solve this by writing it out as a system of ordinary differential equations</para>
          <equation id="id2260442">
            <m:math mode="display">
              <m:mtable displaystyle="true">
                <m:mtr>
                  <m:mtd columnalign="right">
                    <m:msup>
                      <m:mi>c</m:mi>
                      <m:mo>'</m:mo>
                    </m:msup>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>=</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mi>d</m:mi>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="right">
                    <m:msup>
                      <m:mi>d</m:mi>
                      <m:mo>'</m:mo>
                    </m:msup>
                  </m:mtd>
                  <m:mtd>
                    <m:mo>=</m:mo>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:msup>
                        <m:mi>M</m:mi>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msup>
                      <m:mi>K</m:mi>
                      <m:mi>c</m:mi>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mi>M</m:mi>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msup>
                      <m:mi>G</m:mi>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:math>
          </equation>
          <equation id="id2260524">
            <m:math mode="display">
              <m:mrow>
                <m:mfrac>
                  <m:mi>∂</m:mi>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:mi>t</m:mi>
                  </m:mrow>
                </m:mfrac>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>c</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>d</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mi>I</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msup>
                            <m:mi>M</m:mi>
                            <m:mrow>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msup>
                          <m:mi>K</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msup>
                            <m:mi>M</m:mi>
                            <m:mrow>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msup>
                          <m:mi>G</m:mi>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>c</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>d</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <figure id="uid8" orient="horizontal">
            <media id="idm926880" alt=""><image src="../../media/dampeigs.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/dampeigs.eps" mime-type="application/postscript" print-width=".5"/></media>
            <caption>Eigenvalues computed from a finite element discretization of a simple string. The progression of the eigenvalues as <m:math><m:mi>a</m:mi></m:math> grows is towards the left and towards the real axis</caption>
          </figure>
          <para id="id2260651">As the damping factor grows from 0 to <m:math><m:mrow><m:mn>6</m:mn><m:mi>π</m:mi></m:mrow></m:math>, the eigenvalues shift further left in the complex plane. At factors of <m:math><m:mi>π</m:mi></m:math>, the two smallest magnitude eigenvalues become completely real, with one moving left and one moving right in the complex plane. The physical significance of this lies in the fact that the real part of the eigenvalue furthest in the right half plane is determines proportionally how quickly the displacement <m:math><m:mi>u</m:mi></m:math> decays. For large values of <m:math><m:mi>a</m:mi></m:math>, the string becomes overdamped, floating in midair, while for smaller values of <m:math><m:mi>a</m:mi></m:math>, the system oscillates before coming to rest. At <m:math><m:mrow><m:mi>a</m:mi><m:mo>=</m:mo><m:mi>π</m:mi></m:mrow></m:math>, the damping is optimal for bringing the string to rest most quickly. This behavior is shown in <link target-id="uid9"/>.</para>
          <figure id="uid9" orient="horizontal">
            <media id="idm4842144" alt=""><image src="../../media/overdamp.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/overdamp.eps" mime-type="application/postscript" print-width=".5"/></media>
            <caption>Displacement of the midpoint of a string for different damping terms. Notice for damping factor <m:math><m:mrow><m:mi>a</m:mi><m:mo>=</m:mo><m:mi>π</m:mi></m:mrow></m:math>, the displacement reaches a steady state fastest.</caption>
          </figure>
        </section>
      </section>
    </section>
    <section id="uid10">
      <title>Networks of strings</title>
      <para id="id2260769">Unlike our simple one dimensional case, it is much more difficult to determine the closed form eigenvalues and eigenfunctions of a network of strings. To this end, we apply the finite element method to numerically simulate the behavior of a network wave equation.</para>
      <section id="uid11">
        <title>Network wave equation</title>
        <para id="id2260784">Let the <m:math><m:mi>i</m:mi></m:math>th string in a network of strings be defined on an interval from <m:math><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:msub><m:mi>ℓ</m:mi><m:mi>i</m:mi></m:msub><m:mo>]</m:mo></m:mrow></m:math>, where <m:math><m:msub><m:mi>ℓ</m:mi><m:mi>i</m:mi></m:msub></m:math> is the length of that particular string. To generalize the wave equation to a network of strings in three dimensions, we reference Schmidt's <link target-id="bid1"/> system of equations for the planar displacement <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> of the <m:math><m:mi>i</m:mi></m:math>th string, where <m:math><m:mrow><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>∈</m:mo><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:msub><m:mi>ℓ</m:mi><m:mi>i</m:mi></m:msub><m:mo>]</m:mo></m:mrow></m:mrow></m:math> . We define the "stensor" matrix</para>
        <equation id="id2260922">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:msub>
                <m:mi>k</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>[</m:mo>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>s</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mi>I</m:mi>
                <m:mo>+</m:mo>
                <m:msub>
                  <m:mi>v</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:msubsup>
                  <m:mi>v</m:mi>
                  <m:mi>i</m:mi>
                  <m:mi>T</m:mi>
                </m:msubsup>
                <m:mo>]</m:mo>
              </m:mrow>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2260995">where <m:math><m:msub><m:mi>k</m:mi><m:mi>i</m:mi></m:msub></m:math> is stiffness, <m:math><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mo>&gt;</m:mo><m:mn>1</m:mn></m:mrow></m:math> is prestress (string tension), and <m:math><m:msub><m:mi>v</m:mi><m:mi>i</m:mi></m:msub></m:math> is a unit vector specifying 3-dimensional orientation of the <m:math><m:mi>i</m:mi></m:math>th string. We characterize network movement by</para>
        <equation id="id2261062">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>ρ</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mi>I</m:mi>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msup>
                    <m:mi>t</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
              <m:mo>=</m:mo>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msubsup>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                    <m:mn>2</m:mn>
                  </m:msubsup>
                </m:mrow>
              </m:mfrac>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2261152">where <m:math><m:msub><m:mi>ρ</m:mi><m:mi>i</m:mi></m:msub></m:math> is the <m:math><m:mi>i</m:mi></m:math>th strings density. <m:math><m:mi>I</m:mi></m:math> is the 3-by-3 identity matrix. Our boundary conditions are Dirichlet at endpoints (displacement is fixed at 0) and a condition enforcing force balance laws and connectivity of each leg at the joint. We define an end of the first string to have position 0, and for the other endpoints, we consider them to be at position <m:math><m:msub><m:mi>ℓ</m:mi><m:mi>k</m:mi></m:msub></m:math> on their respective <m:math><m:mi>k</m:mi></m:math>th string. Our Dirichlet conditions can be written as</para>
        <equation id="id2255397">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mn>0</m:mn>
              <m:mo>,</m:mo>
              <m:mspace width="1.em"/>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mi>k</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>ℓ</m:mi>
                  <m:mi>k</m:mi>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mn>0</m:mn>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2255464">If we define the set <m:math><m:msub><m:mi>S</m:mi><m:mi>i</m:mi></m:msub></m:math> to be the set of integer indices of all strings incident to a joint at the end of the <m:math><m:mi>i</m:mi></m:math>th string, the force-balance joint conditions connecting strings in the set <m:math><m:mrow><m:mo>{</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:msub><m:mi>S</m:mi><m:mi>i</m:mi></m:msub><m:mo>}</m:mo></m:mrow></m:math> can be described by</para>
        <equation id="id2261483">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mfrac>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>ℓ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:munder>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>j</m:mi>
                  <m:mo>∈</m:mo>
                  <m:msub>
                    <m:mi>S</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mrow>
              </m:munder>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mfrac>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2261606">This network wave equation matrix <m:math><m:msub><m:mi>P</m:mi><m:mi>i</m:mi></m:msub></m:math> can also be mathematically derived from the nonlinear model of Antman; the linear, one dimensional wave equation is derived by taking the orientation vector <m:math><m:mi>v</m:mi></m:math> to be a standard basis vector.</para>
        <figure id="uid12" orient="horizontal">
          <media id="idm3550160" alt=""><image src="../../media/tritarpure.png" mime-type="image/png" width="501"/><image for="pdf" src="../../media/tritarpure.eps" mime-type="application/postscript" print-width=".4"/></media>
          <caption>An example of the notation for the simple tritar case.</caption>
        </figure>
        <para id="id2261651">The network wave equation is much more tractable for a concrete example. We begin by covering the network wave equation for the simplest net - a Y-shaped net called a “tritar", in honor of the guitar with Y-shaped strings (see http://www.tritare.com). For our simple case, then, we have the boundary conditions</para>
        <equation id="id2261665">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mn>0</m:mn>
              <m:mo>,</m:mo>
              <m:mspace width="1.em"/>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mn>2</m:mn>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>ℓ</m:mi>
                  <m:mn>2</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mn>0</m:mn>
              <m:mo>,</m:mo>
              <m:mspace width="1.em"/>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mn>3</m:mn>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>ℓ</m:mi>
                  <m:mn>3</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mn>0</m:mn>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2261794">with the force balance equation</para>
        <equation id="id2261800">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mn>1</m:mn>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                </m:mrow>
              </m:mfrac>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>ℓ</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mn>2</m:mn>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mn>2</m:mn>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>2</m:mn>
                  </m:msub>
                </m:mrow>
              </m:mfrac>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>+</m:mo>
              <m:msub>
                <m:mi>P</m:mi>
                <m:mn>3</m:mn>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mn>3</m:mn>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mn>3</m:mn>
                  </m:msub>
                </m:mrow>
              </m:mfrac>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
                <m:mi>t</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2261950">We will investigate this example further using a discretization of the network.</para>
      </section>
      <section id="uid13">
        <title>Finite element discretization of the network wave equation</title>
        <para id="id2261965">To model behavior and structure of a continuous network, we discretize and solve our equations using the finite element method. For the most part, applying FEM to our network model is the same as applying it to a simple string - the hat functions overlap and form a basis for the structure of each leg. The exception is at a joint, which has a new type of hat function, with its support spanning a small section of each string connected at that joint.</para>
        <figure id="uid14" orient="horizontal">
          <media id="idm4355680" alt=""><image src="../../media/tritarHats.png" mime-type="image/png" width="423"/><image for="pdf" src="../../media/tritarHats.eps" mime-type="application/postscript" print-width=".48"/></media>
          <caption>Finite element discretization of a tritar, with a pyramidal hat function <m:math><m:msub><m:mi>φ</m:mi><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub></m:msub></m:math> at the joint. <m:math><m:mrow><m:msup><m:mi>r</m:mi><m:mn>1</m:mn></m:msup><m:mo>,</m:mo><m:msup><m:mi>r</m:mi><m:mn>2</m:mn></m:msup></m:mrow></m:math> and <m:math><m:msup><m:mi>r</m:mi><m:mn>3</m:mn></m:msup></m:math> denote the first, second, and third strings, respectively, which are discretized into <m:math><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub></m:math>,<m:math><m:msub><m:mi>n</m:mi><m:mn>2</m:mn></m:msub></m:math>, and <m:math><m:msub><m:mi>n</m:mi><m:mn>3</m:mn></m:msub></m:math> parts, respectively.</caption>
        </figure>
        <section id="uid15">
          <title>The tritar example case</title>
          <para id="id2262101">Let us write out the discretization for the example net in <link target-id="uid14"/>. If we take a uniform discretization of each string into <m:math><m:mrow><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:msub><m:mi>n</m:mi><m:mn>2</m:mn></m:msub></m:mrow></m:math>, and <m:math><m:msub><m:mi>n</m:mi><m:mn>3</m:mn></m:msub></m:math> pieces (with <m:math><m:mrow><m:mi>N</m:mi><m:mo>=</m:mo><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>n</m:mi><m:mn>2</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>n</m:mi><m:mn>3</m:mn></m:msub></m:mrow></m:math>), respectively, we can again derive a system of differential equations to describe the evolution of the coefficients <m:math><m:mrow><m:msub><m:mi>c</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> over time. Define the <m:math><m:mi>N</m:mi></m:math> basis hat functions as being . Consider first the <m:math><m:mi>k</m:mi></m:math>th hat function on string <m:math><m:mi>i</m:mi></m:math>, where <m:math><m:mrow><m:mi>k</m:mi><m:mo>≠</m:mo><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub></m:mrow></m:math>. We multiply each side of the network wave equation by the non-joint hat functions <m:math><m:msub><m:mi>φ</m:mi><m:mi>k</m:mi></m:msub></m:math> and integrate over the support of that function. After integration by parts, we have the relation</para>
          <equation id="id2262281">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>ρ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mi>I</m:mi>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>k</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>φ</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2262486">analagous to the one dimensional finite element discretization of a string. If we substitute in our approximation from the basis of hat functions</para>
          <equation id="id2262494">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>u</m:mi>
                  <m:mi>N</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2262560">we arrive at the relation</para>
          <equation id="id2262566">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>ρ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mi>I</m:mi>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:msub>
                      <m:mi>c</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>k</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>φ</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>φ</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2262831">Let <m:math><m:mi>L</m:mi></m:math> be the number of connections in our web; <m:math><m:mrow><m:mi>L</m:mi><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math> for our tritar. Defining our inner products <m:math><m:mfenced separators="" open="〈" close="〉"><m:mo>·</m:mo><m:mo>,</m:mo><m:mo>·</m:mo></m:mfenced></m:math> and <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:mo>·</m:mo><m:mo>,</m:mo><m:mo>·</m:mo></m:mfenced></m:mrow></m:math> as</para>
          <equation id="id2262906">
            <m:math mode="display">
              <m:mrow>
                <m:mfenced separators="" open="〈" close="〉">
                  <m:mi>u</m:mi>
                  <m:mo>,</m:mo>
                  <m:mi>v</m:mi>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>L</m:mi>
                </m:munderover>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mi>u</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mi>v</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>,</m:mo>
                <m:mspace width="1.em"/>
                <m:mi>a</m:mi>
                <m:mfenced separators="" open="(" close=")">
                  <m:mi>u</m:mi>
                  <m:mo>,</m:mo>
                  <m:mi>v</m:mi>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>L</m:mi>
                </m:munderover>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:mi>u</m:mi>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:mi>v</m:mi>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2263138">we see these inner products behave much like the simple string inner products on the topology our network. This gives the relation</para>
          <equation id="uid16">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>ρ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mi>I</m:mi>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:msub>
                      <m:mi>c</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:mfenced separators="" open="〈" close="〉">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mi>a</m:mi>
                <m:mfenced separators="" open="(" close=")">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2263316">The joint is a different case. Let us our joint hat function be <m:math><m:mrow><m:msub><m:mi>φ</m:mi><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. Then, since integration by parts moves a derivative from one function to another with the addition of a boundary value, we get</para>
          <equation id="id2263353">
            <m:math mode="display">
              <m:mtable displaystyle="true">
                <m:mtr>
                  <m:mtd columnalign="right">
                    <m:mrow>
                      <m:msub>
                        <m:mi>ρ</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mi>I</m:mi>
                      <m:msubsup>
                        <m:mo>∫</m:mo>
                        <m:mn>0</m:mn>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:msubsup>
                      <m:mfrac>
                        <m:mrow>
                          <m:msup>
                            <m:mi>∂</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msup>
                            <m:mi>t</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                        </m:mrow>
                      </m:mfrac>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:msub>
                        <m:mi>φ</m:mi>
                        <m:msub>
                          <m:mi>n</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mspace width="0.166667em"/>
                      <m:mi>d</m:mi>
                      <m:msub>
                        <m:mi>x</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mo>=</m:mo>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:msubsup>
                        <m:mo>∫</m:mo>
                        <m:mn>0</m:mn>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:msubsup>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>φ</m:mi>
                            <m:msub>
                              <m:mi>n</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mspace width="0.166667em"/>
                      <m:mi>d</m:mi>
                      <m:msub>
                        <m:mi>x</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="right">
                    <m:mrow>
                      <m:msub>
                        <m:mi>ρ</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:mi>I</m:mi>
                      <m:msubsup>
                        <m:mo>∫</m:mo>
                        <m:mn>0</m:mn>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:msubsup>
                      <m:mfrac>
                        <m:mrow>
                          <m:msup>
                            <m:mi>∂</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msup>
                            <m:mi>t</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                        </m:mrow>
                      </m:mfrac>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:msub>
                        <m:mi>φ</m:mi>
                        <m:msub>
                          <m:mi>n</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mspace width="0.166667em"/>
                      <m:mi>d</m:mi>
                      <m:msub>
                        <m:mi>x</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:mo>=</m:mo>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mn>0</m:mn>
                        <m:mo>,</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:msubsup>
                        <m:mo>∫</m:mo>
                        <m:mn>0</m:mn>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:msubsup>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>φ</m:mi>
                            <m:msub>
                              <m:mi>n</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mspace width="0.166667em"/>
                      <m:mi>d</m:mi>
                      <m:msub>
                        <m:mi>x</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="right">
                    <m:mrow>
                      <m:msub>
                        <m:mi>ρ</m:mi>
                        <m:mn>3</m:mn>
                      </m:msub>
                      <m:mi>I</m:mi>
                      <m:msubsup>
                        <m:mo>∫</m:mo>
                        <m:mn>0</m:mn>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:msubsup>
                      <m:mfrac>
                        <m:mrow>
                          <m:msup>
                            <m:mi>∂</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msup>
                            <m:mi>t</m:mi>
                            <m:mn>2</m:mn>
                          </m:msup>
                        </m:mrow>
                      </m:mfrac>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                        <m:mo>,</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:msub>
                        <m:mi>φ</m:mi>
                        <m:msub>
                          <m:mi>n</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>x</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mspace width="0.166667em"/>
                      <m:mi>d</m:mi>
                      <m:msub>
                        <m:mi>x</m:mi>
                        <m:mn>3</m:mn>
                      </m:msub>
                      <m:mo>=</m:mo>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>3</m:mn>
                      </m:msub>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mn>0</m:mn>
                        <m:mo>,</m:mo>
                        <m:mi>t</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>P</m:mi>
                        <m:mn>3</m:mn>
                      </m:msub>
                      <m:msubsup>
                        <m:mo>∫</m:mo>
                        <m:mn>0</m:mn>
                        <m:msub>
                          <m:mi>ℓ</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:msubsup>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>u</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mfrac>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>φ</m:mi>
                            <m:msub>
                              <m:mi>n</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:msub>
                        </m:mrow>
                        <m:mrow>
                          <m:mi>∂</m:mi>
                          <m:msub>
                            <m:mi>x</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mfrac>
                      <m:mspace width="0.166667em"/>
                      <m:mi>d</m:mi>
                      <m:msub>
                        <m:mi>x</m:mi>
                        <m:mn>3</m:mn>
                      </m:msub>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:math>
          </equation>
          <para id="id2264140">after integrating over each string where the joint hat function is nonzero. If we recall that our force balance equation was</para>
          <equation id="id2264148">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>-</m:mo>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mn>2</m:mn>
                </m:msub>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>2</m:mn>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mn>0</m:mn>
                  <m:mo>,</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>-</m:mo>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mn>3</m:mn>
                </m:msub>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mn>3</m:mn>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mn>3</m:mn>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mn>0</m:mn>
                  <m:mo>,</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>=</m:mo>
                <m:mn>0</m:mn>
                <m:mo>,</m:mo>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2264304">however, we can sum these equations together to achieve the relation</para>
          <equation id="id2264311">
            <m:math mode="display">
              <m:mrow>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mn>3</m:mn>
                </m:munderover>
                <m:msub>
                  <m:mi>ρ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mi>I</m:mi>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:msub>
                    <m:mi>n</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mn>3</m:mn>
                </m:munderover>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>φ</m:mi>
                      <m:msub>
                        <m:mi>n</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2264558">Conveniently, the force balance equation allows us to generalize this condition to joints with multiple legs as well. Next, substituting in <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mi>N</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>N</m:mi></m:msubsup><m:msub><m:mi>c</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, we get</para>
          <equation id="id2264632">
            <m:math mode="display">
              <m:mrow>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mn>3</m:mn>
                </m:munderover>
                <m:msub>
                  <m:mi>ρ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mi>I</m:mi>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:msub>
                      <m:mi>c</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msub>
                  <m:mi>φ</m:mi>
                  <m:msub>
                    <m:mi>n</m:mi>
                    <m:mn>1</m:mn>
                  </m:msub>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mn>3</m:mn>
                </m:munderover>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:mn>0</m:mn>
                  <m:msub>
                    <m:mi>ℓ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msubsup>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>φ</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mfrac>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>φ</m:mi>
                      <m:msub>
                        <m:mi>n</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                    </m:msub>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mfrac>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2264939">If we define <m:math><m:mrow><m:mover accent="true"><m:mi>ρ</m:mi><m:mo>¯</m:mo></m:mover><m:mo>=</m:mo><m:msub><m:mi>ρ</m:mi><m:mn>1</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>ρ</m:mi><m:mn>2</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>ρ</m:mi><m:mn>3</m:mn></m:msub></m:mrow></m:math> and <m:math><m:mrow><m:mover accent="true"><m:mi>P</m:mi><m:mo>¯</m:mo></m:mover><m:mo>=</m:mo><m:msub><m:mi>P</m:mi><m:mn>1</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>P</m:mi><m:mn>2</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>P</m:mi><m:mn>3</m:mn></m:msub></m:mrow></m:math>, we are then left with the relation</para>
          <equation id="uid17">
            <m:math mode="display">
              <m:mrow>
                <m:mover accent="true">
                  <m:mi>ρ</m:mi>
                  <m:mo>¯</m:mo>
                </m:mover>
                <m:mi>I</m:mi>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:mfrac>
                  <m:mrow>
                    <m:msup>
                      <m:mi>∂</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:msub>
                      <m:mi>c</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>t</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:msup>
                      <m:mi>t</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mfrac>
                <m:mfenced separators="" open="〈" close="〉">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:msub>
                      <m:mi>n</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:mover accent="true">
                  <m:mi>P</m:mi>
                  <m:mo>¯</m:mo>
                </m:mover>
                <m:munderover>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                  <m:mi>N</m:mi>
                </m:munderover>
                <m:msub>
                  <m:mi>c</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>t</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mi>a</m:mi>
                <m:mfenced separators="" open="(" close=")">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:msub>
                      <m:mi>n</m:mi>
                      <m:mn>1</m:mn>
                    </m:msub>
                  </m:msub>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2265222">Together, equations (<link target-id="uid16"/>) and (<link target-id="uid17"/>) provide us with a system of equations <m:math><m:mrow><m:mi>M</m:mi><m:msup><m:mi>c</m:mi><m:mrow><m:mo>'</m:mo><m:mo>'</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mi>K</m:mi><m:mi>c</m:mi></m:mrow></m:math> from which to determine our coefficients <m:math><m:mrow><m:msub><m:mi>c</m:mi><m:mi>k</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>t</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, where <m:math><m:mi>M</m:mi></m:math> and <m:math><m:mi>K</m:mi></m:math> are</para>
          <equation id="id2265307">
            <m:math mode="display">
              <m:mrow>
                <m:mi>M</m:mi>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>11</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>12</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mo>...</m:mo>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mrow>
                              <m:mn>1</m:mn>
                              <m:mi>N</m:mi>
                            </m:mrow>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>21</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>22</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mo>...</m:mo>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mrow>
                              <m:mn>2</m:mn>
                              <m:mi>N</m:mi>
                            </m:mrow>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mo>⋮</m:mo>
                      </m:mtd>
                      <m:mtd/>
                      <m:mtd>
                        <m:mo>⋱</m:mo>
                      </m:mtd>
                      <m:mtd/>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mrow>
                              <m:mi>N</m:mi>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mrow>
                              <m:mi>N</m:mi>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mo>...</m:mo>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mrow>
                              <m:mi>N</m:mi>
                              <m:mi>N</m:mi>
                            </m:mrow>
                          </m:msub>
                          <m:mi>I</m:mi>
                          <m:mfenced separators="" open="〈" close="〉">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <equation id="id2265703">
            <m:math mode="display">
              <m:mrow>
                <m:mi>K</m:mi>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>11</m:mn>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>12</m:mn>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mo>...</m:mo>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mrow>
                              <m:mn>1</m:mn>
                              <m:mi>N</m:mi>
                            </m:mrow>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>21</m:mn>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>22</m:mn>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mo>...</m:mo>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mrow>
                              <m:mn>2</m:mn>
                              <m:mi>N</m:mi>
                            </m:mrow>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mo>⋮</m:mo>
                      </m:mtd>
                      <m:mtd/>
                      <m:mtd>
                        <m:mo>⋱</m:mo>
                      </m:mtd>
                      <m:mtd/>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mrow>
                              <m:mi>N</m:mi>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>1</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mrow>
                              <m:mi>N</m:mi>
                              <m:mn>2</m:mn>
                            </m:mrow>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mn>2</m:mn>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mo>...</m:mo>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mrow>
                              <m:mi>N</m:mi>
                              <m:mi>N</m:mi>
                            </m:mrow>
                          </m:msub>
                          <m:mi>a</m:mi>
                          <m:mfenced separators="" open="(" close=")">
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                            <m:mo>,</m:mo>
                            <m:msub>
                              <m:mi>φ</m:mi>
                              <m:mi>N</m:mi>
                            </m:msub>
                          </m:mfenced>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mo>,</m:mo>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2266094">where <m:math><m:msub><m:mi>ρ</m:mi><m:mrow><m:mi>j</m:mi><m:mi>k</m:mi></m:mrow></m:msub></m:math> and <m:math><m:msub><m:mi>P</m:mi><m:mrow><m:mi>j</m:mi><m:mi>k</m:mi></m:mrow></m:msub></m:math> are linear combinations of <m:math><m:msub><m:mi>ρ</m:mi><m:mi>i</m:mi></m:msub></m:math> and <m:math><m:msub><m:mi>P</m:mi><m:mi>i</m:mi></m:msub></m:math> that are determined by the geometry of the network.</para>
          <para id="id2266166">If we assume <m:math><m:mrow><m:msub><m:mi>ℓ</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> for <m:math><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mn>3</m:mn></m:mrow></m:math>, then the inner product of two non-joint hat functions is exactly the same as in the one-dimensional case, where</para>
          <equation id="id2266215">
            <m:math mode="display">
              <m:mrow>
                <m:mfenced separators="" open="〈" close="〉">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="{" close="">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mrow>
                            <m:mn>2</m:mn>
                            <m:mi>h</m:mi>
                          </m:mrow>
                          <m:mo>/</m:mo>
                          <m:mn>3</m:mn>
                          <m:mo>,</m:mo>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mspace width="1.em"/>
                          <m:mtext>if</m:mtext>
                          <m:mspace width="4.pt"/>
                          <m:mrow>
                            <m:mi>i</m:mi>
                            <m:mo>=</m:mo>
                            <m:mi>j</m:mi>
                          </m:mrow>
                          <m:mtext>;</m:mtext>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mi>h</m:mi>
                          <m:mo>/</m:mo>
                          <m:mn>3</m:mn>
                          <m:mo>,</m:mo>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mspace width="1.em"/>
                          <m:mtext>if</m:mtext>
                          <m:mspace width="4.pt"/>
                          <m:mrow>
                            <m:mo>|</m:mo>
                            <m:mi>i</m:mi>
                            <m:mo>-</m:mo>
                            <m:mi>j</m:mi>
                            <m:mo>|</m:mo>
                            <m:mo>=</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                          <m:mtext>;</m:mtext>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mn>0</m:mn>
                          <m:mo>,</m:mo>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mspace width="1.em"/>
                          <m:mtext>otherwise.</m:mtext>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2266365">and</para>
          <equation id="id2266371">
            <m:math mode="display">
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mfenced separators="" open="(" close=")">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="{" close="">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mrow>
                            <m:mo>-</m:mo>
                            <m:mn>2</m:mn>
                          </m:mrow>
                          <m:mo>/</m:mo>
                          <m:mi>h</m:mi>
                          <m:mo>,</m:mo>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mspace width="1.em"/>
                          <m:mtext>if</m:mtext>
                          <m:mspace width="4.pt"/>
                          <m:mrow>
                            <m:mi>i</m:mi>
                            <m:mo>=</m:mo>
                            <m:mi>j</m:mi>
                          </m:mrow>
                          <m:mtext>;</m:mtext>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mn>1</m:mn>
                          <m:mo>/</m:mo>
                          <m:mi>h</m:mi>
                          <m:mo>,</m:mo>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mspace width="1.em"/>
                          <m:mtext>if</m:mtext>
                          <m:mspace width="4.pt"/>
                          <m:mrow>
                            <m:mo>|</m:mo>
                            <m:mi>i</m:mi>
                            <m:mo>-</m:mo>
                            <m:mi>j</m:mi>
                            <m:mo>|</m:mo>
                            <m:mo>=</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                          <m:mtext>;</m:mtext>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mn>0</m:mn>
                          <m:mo>,</m:mo>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd columnalign="left">
                        <m:mrow>
                          <m:mspace width="1.em"/>
                          <m:mtext>otherwise.</m:mtext>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2266524">Let us take <m:math><m:mrow><m:msub><m:mi>n</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo><m:mn>4</m:mn></m:mrow></m:math> and <m:math><m:mrow><m:msub><m:mi>n</m:mi><m:mn>2</m:mn></m:msub><m:mo>=</m:mo><m:msub><m:mi>n</m:mi><m:mn>3</m:mn></m:msub><m:mo>=</m:mo><m:mn>3</m:mn></m:mrow></m:math>. For this network , if we assume all the legs of the tritar lie at equal angles from each other, we can define the orientation <m:math><m:mrow><m:msub><m:mi>v</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>]</m:mo></m:mrow></m:mrow></m:math>, <m:math><m:mrow><m:msub><m:mi>v</m:mi><m:mn>2</m:mn></m:msub><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mo>.</m:mo><m:mn>5</m:mn><m:mo>,</m:mo><m:mo>.</m:mo><m:mn>5</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>]</m:mo></m:mrow></m:mrow></m:math>, <m:math><m:mrow><m:msub><m:mi>v</m:mi><m:mn>3</m:mn></m:msub><m:mo>=</m:mo><m:mrow><m:mo>[</m:mo><m:mo>.</m:mo><m:mn>5</m:mn><m:mo>,</m:mo><m:mo>-</m:mo><m:mo>.</m:mo><m:mn>5</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>]</m:mo></m:mrow></m:mrow></m:math>. Suppose <m:math><m:mrow><m:msub><m:mi>s</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>2</m:mn></m:mrow></m:math>, <m:math><m:mrow><m:msub><m:mi>k</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, <m:math><m:mrow><m:msub><m:mi>ρ</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>. Then,</para>
          <equation id="id2266751">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mn>1</m:mn>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>2</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>1</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>1</m:mn>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mo>,</m:mo>
                <m:mspace width="1.em"/>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mn>2</m:mn>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>5</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>1</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>1</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>5</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>1</m:mn>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mo>,</m:mo>
                <m:mspace width="1.em"/>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mn>3</m:mn>
                </m:msub>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>5</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>5</m:mn>
                          <m:mo>/</m:mo>
                          <m:mn>4</m:mn>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>1</m:mn>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2266968">and we can assemble <m:math><m:mi>M</m:mi></m:math> and <m:math><m:mi>K</m:mi></m:math> as follows</para>
          <equation id="id2266993">
            <m:math mode="display">
              <m:mrow>
                <m:mi>M</m:mi>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:mi>h</m:mi>
                  <m:mn>6</m:mn>
                </m:mfrac>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>2</m:mn>
                          <m:mover accent="true">
                            <m:mi>ρ</m:mi>
                            <m:mo>¯</m:mo>
                          </m:mover>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mn>4</m:mn>
                          <m:msub>
                            <m:mi>ρ</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                          <m:mi>I</m:mi>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <equation id="id2267621">
            <m:math mode="display">
              <m:mrow>
                <m:mi>K</m:mi>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:mi>h</m:mi>
                </m:mfrac>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>1</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>1</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mover accent="true">
                            <m:mi>P</m:mi>
                            <m:mo>¯</m:mo>
                          </m:mover>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>2</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>2</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:msub>
                          <m:mi>P</m:mi>
                          <m:mn>3</m:mn>
                        </m:msub>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mn>2</m:mn>
                          <m:msub>
                            <m:mi>P</m:mi>
                            <m:mn>3</m:mn>
                          </m:msub>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2268186">We can reverse engineer some of the geometry of our network from examination of these matrices - notice that each leg has 3 blocks assigned to it, corresponding to the 3 non-joint hat functions on each string. The far off-diagonal terms capture the connection of the first string to the third string, and the presence of <m:math><m:mover accent="true"><m:mi>ρ</m:mi><m:mo>¯</m:mo></m:mover></m:math> and <m:math><m:mover accent="true"><m:mi>P</m:mi><m:mo>¯</m:mo></m:mover></m:math> on the diagonal stems from the inner product of the joint hat function with the hat functions on each of the strings.</para>
        </section>
        <section id="uid18">
          <title>Generalized numbering scheme and <!--Math is not currently allowed in CNXML section title.-->-adaptivity</title>
          <para id="id2268248">Unfortunately, for larger and more complex webs, writing the system out by hand becomes far too tedious. We seek a more systematic and flexible way of producing our finite element discretizations. We should note two things about finite element discretizations. First, if we stay consistent, a reordering of the nodes does not affect our discretization, though it may change the structure of our matrix. Secondly, our hat functions are not required to be either uniform or symmetric - they can vary in width depending on index, and one side can have a different width than another. This idea is known as <m:math><m:mi>h</m:mi></m:math>-adaptivity; advanced finite element methods tend to adapt their discretizations by using error estimates from iteration to iteration to pinpoint areas where a coarse discretization should be refined to allow for greater accuracy.</para>
          <para id="id2268274">Knowing this, it is possible to produce a generalized finite element discretization of a web given only physical constants, a set of nodal points and each point's neighbors. Given this, we can calculate the step size <m:math><m:mi>h</m:mi></m:math> and orientation <m:math><m:mi>v</m:mi></m:math> from node to node, and thus reconstruct our <m:math><m:msub><m:mi>P</m:mi><m:mi>i</m:mi></m:msub></m:math> matrices. Knowing the neighbors of each node would allow us to reconstruct the structure of our <m:math><m:mi>M</m:mi></m:math> and <m:math><m:mi>K</m:mi></m:math> matrices as well. If we examine <m:math><m:mi>M</m:mi></m:math> and <m:math><m:mi>K</m:mi></m:math>, we can see they are formed out of an <m:math><m:mi>N</m:mi></m:math> by <m:math><m:mi>N</m:mi></m:math> block grid, where each block is a 3 by 3 matrix. Previously, the index <m:math><m:mi>i</m:mi></m:math> differentiated between constants and different legs/connections in our network. In this generalized scheme, we allow <m:math><m:mi>i</m:mi></m:math> and <m:math><m:mi>j</m:mi></m:math> to reference different nodes in our discretization instead. Thus, a connection between a node <m:math><m:mi>i</m:mi></m:math> and <m:math><m:mi>j</m:mi></m:math> implies a nonzero entry in the <m:math><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:math>th block, and <m:math><m:msub><m:mi>k</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>, and <m:math><m:msub><m:mi>s</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math> refers to the value of the physical constants on the shared support of the hat functions <m:math><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub></m:math> and <m:math><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:math>. Utilizing this generalized scheme allows for much more flexibility in terms of our physical constants as well; for example, if the stiffness <m:math><m:mi>k</m:mi></m:math> varied as function of <m:math><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub></m:math>, we could capture this by varying our stiffness <m:math><m:mi>k</m:mi></m:math> from node to node. We go into more detail on this in the next section.</para>
          <para id="id2268536">Many of the concepts from the single-string case carry over to networks.</para>
        </section>
        <section id="uid19">
          <title>Assembling the <!--Math is not currently allowed in CNXML section title.--> and <!--Math is not currently allowed in CNXML section title.--> matrices</title>
          <para id="id2268567">We begin by describing the notation of the information represented by our data structures. We denote the <m:math><m:mi>i</m:mi></m:math>th node to have <m:math><m:mrow><m:mi>x</m:mi><m:mi>y</m:mi><m:mi>z</m:mi></m:mrow></m:math> position vector <m:math><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub></m:math>. For each node at <m:math><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub></m:math>, there is an associated set of the indices of connected neighbor nodes <m:math><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:math> and a set <m:math><m:msub><m:mi>C</m:mi><m:mi>i</m:mi></m:msub></m:math> containing the physical constants <m:math><m:mrow><m:msub><m:mi>k</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub><m:mo>,</m:mo><m:msub><m:mi>s</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:mrow></m:math> pertaining to the connection between nodes <m:math><m:mi>i</m:mi></m:math> and <m:math><m:mrow><m:mi>j</m:mi><m:mo>∈</m:mo><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>. Since we can divide through by <m:math><m:msub><m:mi>ρ</m:mi><m:mi>i</m:mi></m:msub></m:math> on both sides of the network wave equation, we can assume without loss of generality that the constant <m:math><m:mrow><m:msub><m:mi>ρ</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, and that any data carried by the density <m:math><m:msub><m:mi>ρ</m:mi><m:mi>i</m:mi></m:msub></m:math> is now contained in <m:math><m:msub><m:mi>k</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>.</para>
          <para id="id2268786">Assuming we are given a set of <m:math><m:mi>N</m:mi></m:math> nodes, along with the <m:math><m:mrow><m:mi>x</m:mi><m:mi>y</m:mi></m:mrow></m:math> positions of each node (the <m:math><m:mi>z</m:mi></m:math> positions are assumed to be 0, such that the web is planar in the <m:math><m:mrow><m:mi>x</m:mi><m:mi>y</m:mi></m:mrow></m:math> plane at rest), our first goal is to compute our step sizes <m:math><m:msub><m:mi>h</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math> and orientation vectors <m:math><m:msub><m:mi>v</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math> for connections between two nodes <m:math><m:mi>i</m:mi></m:math> and <m:math><m:mrow><m:mi>j</m:mi><m:mo>∈</m:mo><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>. To account for Dirichlet boundary conditions, we also create an anchored node for each endpoint. In this implementation, if a node has only one neighbor, we assume it is connected to a pinned endpoint whose position is in the opposite direction but the same distance away as the only neighbor (this is required to calculate an inner product). For a node connected to an endpoint, we append the index 0 to <m:math><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:math>.</para>
          <para id="id2268921">Given <m:math><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub></m:math>, <m:math><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:math>, <m:math><m:msub><m:mi>C</m:mi><m:mi>i</m:mi></m:msub></m:math>, we proceed as follows</para>
          <list id="id2268967" list-type="enumerated">
            <item id="uid20">for each <m:math><m:mi>i</m:mi></m:math> from <m:math><m:mrow><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>N</m:mi></m:mrow></m:math><list id="id2269012" list-type="enumerated"><item id="uid21">for all <m:math><m:mrow><m:mi>j</m:mi><m:mo>∈</m:mo><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>, calculate <m:math><m:mrow><m:msub><m:mi>h</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:msub><m:mrow><m:mo>∥</m:mo><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub><m:mo>-</m:mo><m:msub><m:mi>p</m:mi><m:mi>j</m:mi></m:msub><m:mo>∥</m:mo></m:mrow><m:mn>2</m:mn></m:msub></m:mrow></m:math></item><item id="uid22">if the number of elements in any set <m:math><m:mrow><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math><list id="id2269122" list-type="enumerated"><item id="uid23">create an “endpoint" node at position <m:math><m:mrow><m:msub><m:mi>p</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>2</m:mn><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub><m:mo>-</m:mo><m:msub><m:mi>p</m:mi><m:mi>j</m:mi></m:msub></m:mrow></m:math>, with step size <m:math><m:mrow><m:msub><m:mi>h</m:mi><m:mrow><m:mi>i</m:mi><m:mn>0</m:mn></m:mrow></m:msub><m:mo>=</m:mo><m:msub><m:mrow><m:mo>∥</m:mo><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub><m:mo>-</m:mo><m:msub><m:mi>p</m:mi><m:mn>0</m:mn></m:msub><m:mo>∥</m:mo></m:mrow><m:mn>2</m:mn></m:msub></m:mrow></m:math></item><item id="uid24">set <m:math><m:mrow><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mrow><m:mo>{</m:mo><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>}</m:mo></m:mrow></m:mrow></m:math> to indicate the <m:math><m:mi>i</m:mi></m:math>th node is connected to an anchor
</item></list></item></list></item>
          </list>
          <para id="id2269280">In practice, we normalize the positions of our nodes such that the web lies within a box of a desired arbitrary size <m:math><m:mi>s</m:mi></m:math>. We do this by calculating the maximum distance <m:math><m:msub><m:mi>d</m:mi><m:mo movablelimits="true" form="prefix">max</m:mo></m:msub></m:math> between the anchored endpoints of a web, then scaling the positions <m:math><m:msub><m:mi>p</m:mi><m:mi>i</m:mi></m:msub></m:math> of every node by the factor <m:math><m:mrow><m:mi>s</m:mi><m:mo>/</m:mo><m:msub><m:mi>d</m:mi><m:mo movablelimits="true" form="prefix">max</m:mo></m:msub></m:mrow></m:math>. Since the absolute positions of the nodes don't affect our discretization, we don't need to worry about subtracting off the centroid of all the node positions.</para>
          <para id="id2269356">With all our variables now in place, we can now proceed to the actual construction of our discretization matrices. This requires knowing <m:math><m:mfenced separators="" open="〈" close="〉"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced></m:math>, <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced></m:mrow></m:math>, and <m:math><m:msub><m:mi>P</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>. We deal first with constructing the <m:math><m:mi>M</m:mi></m:math> matrix, which requires only knowledge of <m:math><m:mfenced separators="" open="〈" close="〉"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced></m:math>. Just as in the case of finite element on the single string, most of the basis functions <m:math><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub></m:math> and <m:math><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:math> don't share support and their inner products are zero. However, in addition to calculating inner products of regular hat functions, we need to compute the inner products with joint, generalized and nonsymmetric hat functions as well.</para>
          <para id="id2269522">Starting with our <m:math><m:mi>M</m:mi></m:math> matrix, we only need to calculate the inner product <m:math><m:mfenced separators="" open="〈" close="〉"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced></m:math> for <m:math><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mi>i</m:mi></m:mrow></m:math> and <m:math><m:mrow><m:mi>j</m:mi><m:mo>∈</m:mo><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>. For the diagonal case <m:math><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mi>i</m:mi></m:mrow></m:math>, we note that our inner product <m:math><m:mrow><m:mfenced separators="" open="〈" close="〉"><m:mi>u</m:mi><m:mo>,</m:mo><m:mi>v</m:mi></m:mfenced><m:mo>=</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>L</m:mi></m:msubsup><m:msubsup><m:mo>∫</m:mo><m:mn>0</m:mn><m:msub><m:mi>ℓ</m:mi><m:mi>i</m:mi></m:msub></m:msubsup><m:mi>u</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mi>v</m:mi><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mspace width="0.166667em"/><m:mi>d</m:mi><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math> needs only be calculated on the support of <m:math><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub></m:math>. For given <m:math><m:mi>i</m:mi></m:math>,</para>
          <equation id="id2269742">
            <m:math mode="display">
              <m:mrow>
                <m:mfenced separators="" open="〈" close="〉">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:munder>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>∈</m:mo>
                    <m:msub>
                      <m:mi>N</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:munder>
                <m:msubsup>
                  <m:mo>∫</m:mo>
                  <m:msub>
                    <m:mi>p</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:msub>
                      <m:mi>p</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>+</m:mo>
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:msubsup>
                <m:msubsup>
                  <m:mi>φ</m:mi>
                  <m:mi>i</m:mi>
                  <m:mn>2</m:mn>
                </m:msubsup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mspace width="0.166667em"/>
                <m:mi>d</m:mi>
                <m:msub>
                  <m:mi>x</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mo>=</m:mo>
                <m:munder>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>∈</m:mo>
                    <m:msub>
                      <m:mi>N</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:munder>
                <m:mfrac>
                  <m:msub>
                    <m:mi>h</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mi>j</m:mi>
                    </m:mrow>
                  </m:msub>
                  <m:mn>3</m:mn>
                </m:mfrac>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2269897">The last part is a generalization of our inner product for a uniform grid on a single string. For the off-diagonal case <m:math><m:mrow><m:mi>j</m:mi><m:mo>∈</m:mo><m:msub><m:mi>N</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>, <m:math><m:mrow><m:mi>j</m:mi><m:mo>≠</m:mo><m:mi>i</m:mi></m:mrow></m:math>, the inner product is analogous to the single-string case.</para>
          <equation id="id2269940">
            <m:math mode="display">
              <m:mrow>
                <m:mfenced separators="" open="〈" close="〉">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mfrac>
                  <m:msub>
                    <m:mi>h</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mi>j</m:mi>
                    </m:mrow>
                  </m:msub>
                  <m:mn>6</m:mn>
                </m:mfrac>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2269992">since two different hat function can overlap on at most one leg (otherwise two legs of a hat function could cover the same support).</para>
          <para id="id2270000">Next, we can create our <m:math><m:mi>K</m:mi></m:math> matrix, which requires knowledge of both <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced></m:mrow></m:math> and our <m:math><m:msub><m:mi>P</m:mi><m:mi>i</m:mi></m:msub></m:math> matrix between nodes <m:math><m:mi>i</m:mi></m:math> and <m:math><m:mi>j</m:mi></m:math>, <m:math><m:msub><m:mi>P</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>. Starting with <m:math><m:msub><m:mi>P</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>, if we have done our bookkeeping correctly, we have all the variables we need to compute</para>
          <equation id="id2270117">
            <m:math mode="display">
              <m:mrow>
                <m:msub>
                  <m:mi>P</m:mi>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mi>j</m:mi>
                  </m:mrow>
                </m:msub>
                <m:mo>=</m:mo>
                <m:msub>
                  <m:mi>k</m:mi>
                  <m:mrow>
                    <m:mi>i</m:mi>
                    <m:mi>j</m:mi>
                  </m:mrow>
                </m:msub>
                <m:mrow>
                  <m:mo>[</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>s</m:mi>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mi>j</m:mi>
                      </m:mrow>
                    </m:msub>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mi>I</m:mi>
                  <m:mo>-</m:mo>
                  <m:msub>
                    <m:mi>v</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mi>j</m:mi>
                    </m:mrow>
                  </m:msub>
                  <m:msubsup>
                    <m:mi>v</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mi>j</m:mi>
                    </m:mrow>
                    <m:mi>T</m:mi>
                  </m:msubsup>
                  <m:mo>]</m:mo>
                </m:mrow>
                <m:mo>,</m:mo>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2270207">after which we only need <m:math><m:mrow><m:mi>a</m:mi><m:mfenced separators="" open="(" close=")"><m:msub><m:mi>φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>φ</m:mi><m:mi>j</m:mi></m:msub></m:mfenced></m:mrow></m:math> for <m:math><m:mrow><m:mo>|</m:mo><m:mi>i</m:mi><m:mo>-</m:mo><m:mi>j</m:mi><m:mo>|</m:mo><m:mo>≤</m:mo><m:mn>1</m:mn></m:mrow></m:math>. For <m:math><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mi>j</m:mi></m:mrow></m:math> on our main diagonal, the energy inner product is just the sum of the integrals <m:math><m:mrow><m:mo>∫</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msubsup><m:mi>φ</m:mi><m:mi>i</m:mi><m:mrow><m:mo>'</m:mo><m:mo>'</m:mo></m:mrow></m:msubsup><m:mrow><m:mo>(</m:mo><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mn>2</m:mn></m:msup><m:mspace width="0.166667em"/><m:mi>d</m:mi><m:msub><m:mi>x</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math> evaluated for each leg of the hat function. If each leg lives on a support of length <m:math><m:msub><m:mi>h</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>, the energy inner product is</para>
          <equation id="id2270368">
            <m:math mode="display">
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mfenced separators="" open="(" close=")">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:munder>
                  <m:mo>∑</m:mo>
                  <m:mrow>
                    <m:mi>j</m:mi>
                    <m:mo>∈</m:mo>
                    <m:msub>
                      <m:mi>N</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:munder>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:msub>
                    <m:mi>h</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mi>j</m:mi>
                    </m:mrow>
                  </m:msub>
                </m:mfrac>
                <m:mo>.</m:mo>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2270442">For <m:math><m:mrow><m:mo>|</m:mo><m:mi>i</m:mi><m:mo>-</m:mo><m:mi>j</m:mi><m:mo>|</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, two hat functions can share support on at most one leg, so our energy inner product is</para>
          <equation id="id2270472">
            <m:math mode="display">
              <m:mrow>
                <m:mi>a</m:mi>
                <m:mfenced separators="" open="(" close=")">
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                  <m:mo>,</m:mo>
                  <m:msub>
                    <m:mi>φ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mo>-</m:mo>
                <m:mfrac>
                  <m:mn>1</m:mn>
                  <m:msub>
                    <m:mi>h</m:mi>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mi>j</m:mi>
                    </m:mrow>
                  </m:msub>
                </m:mfrac>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2270528">which again is analogous to our single-string case.</para>
        </section>
        <section id="uid25">
          <title>Damping</title>
          <para id="id2270542">The case of the damped network wave equation is worth examining as well, especially in the mathematical modeling of a spider's web. The material properties of spiderwebs also make it ideal for simulation via the second order wave equation. These include minimal torsion (twisting) in vibrations, low stiffness, no hysteresis under small strains, and a loss of energy primarily through aerodynamic damping. The wave equation assumes negligible torsion and low stiffness, is meant to model string movement specifically under small strains, and is easy to add a constant aerodynamic/viscous damping term to.</para>
          <para id="id2270556">Since the structure of our damping matrix <m:math><m:mi>G</m:mi></m:math> is built from the same inner products as our <m:math><m:mi>M</m:mi></m:math> matrix; the only difference is that we now have to keep track of one more constant, the damping coefficient on a connection between two nodal points <m:math><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>. The <m:math><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:math>th block of <m:math><m:mi>G</m:mi></m:math> is then just the <m:math><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:math>th block of <m:math><m:mi>M</m:mi></m:math> scaled by <m:math><m:msub><m:mi>a</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math>. This allows us to again vary damping from connection to connection, which proves useful in the simulation of spider webs, since the radial and axial fibers of a spiderweb are often subject to different levels of damping.</para>
        </section>
      </section>
      <section id="uid26">
        <title>Matlab GUI</title>
        <para id="id2270671">With this last bit of information, we know each block entry of our <m:math><m:mi>N</m:mi></m:math> blocks by <m:math><m:mi>N</m:mi></m:math> blocks discretization matrices, and can construct a finite element discretization for a web given only a list of nodes, their positions, and their connectivity. To implement this in an accessible way, a Matlab “point-and-click" GUI was developed to allow users to trace and experiment with their own webs through numerical simulations of web motion and analysis of the eigenvalues and fundamental modes.</para>
        <figure id="uid27" orient="horizontal">
          <media id="idp4365440" alt=""><image src="../../media/GUIscreenshot.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/GUIscreenshot.eps" mime-type="application/postscript" print-width=".6"/></media>
          <caption>A screenshot of the GUI. With the web outline drawn, we can continue to refine our grid until we achieve a desired size.</caption>
        </figure>
        <section id="uid28">
          <title>Setting up the web</title>
          <para id="id2270727">Using a GUI to wrap around our framework which allows the user to point and click to place nodes down, then to click from one node to another to specify the connection pattern. Endpoints (where the nodes are pinned down, enforcing Dirichlet boundary conditions) are assumed to be nodes with only one neighbor (i.e., not a link in a chain). Once the initial pattern is set, the user can change the discretization fineness as desired, as well as rescale the size of the web to a larger or small grid. When the user is done, the positions and connection pattern of the nodes can be used to create a finite element discretization of the network of strings.</para>
          <para id="id2270752">While code behind the discretization of the web remains the main engine driving the mathematics of this model, the GUI has probably been where most of the work has gone, making the creation of webs accessible to anyone, although it's still possible to create a web simply by loading a data file.</para>
        </section>
        <section id="uid29">
          <title>Solving for the solution with FEM</title>
          <para id="id2270769">Along with calculating eigenvalues, we can solve a system of differential equations in order to solve our second order PDE once given our <m:math><m:mi>M</m:mi></m:math>,<m:math><m:mi>K</m:mi></m:math>, and <m:math><m:mi>G</m:mi></m:math> matrices. Since the wave equation with damping can be written as an ODE system</para>
          <equation id="id2270804">
            <m:math mode="display">
              <m:mrow>
                <m:mfrac>
                  <m:mi>∂</m:mi>
                  <m:mrow>
                    <m:mi>∂</m:mi>
                    <m:mi>t</m:mi>
                  </m:mrow>
                </m:mfrac>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>c</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>d</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mi>I</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:msup>
                            <m:mi>M</m:mi>
                            <m:mrow>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msup>
                          <m:mi>K</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:msup>
                            <m:mi>M</m:mi>
                            <m:mrow>
                              <m:mo>-</m:mo>
                              <m:mn>1</m:mn>
                            </m:mrow>
                          </m:msup>
                          <m:mi>G</m:mi>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>c</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>d</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2270905">Since <m:math><m:mi>M</m:mi></m:math> is positive definite, we can compute the matrix-vector product <m:math><m:mrow><m:msup><m:mi>M</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mi>K</m:mi><m:mi>c</m:mi></m:mrow></m:math> and <m:math><m:mrow><m:msup><m:mi>M</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mi>G</m:mi><m:mi>d</m:mi></m:mrow></m:math> using the Cholesky factorization <m:math><m:mrow><m:mi>M</m:mi><m:mo>=</m:mo><m:msup><m:mi>C</m:mi><m:mi>T</m:mi></m:msup><m:mi>C</m:mi></m:mrow></m:math>, where <m:math><m:mi>C</m:mi></m:math> is an upper triangular matrix. We can then compute</para>
          <equation id="id2270999">
            <m:math mode="display">
              <m:mrow>
                <m:msup>
                  <m:mi>d</m:mi>
                  <m:mo>'</m:mo>
                </m:msup>
                <m:mo>=</m:mo>
                <m:msup>
                  <m:mi>C</m:mi>
                  <m:mrow>
                    <m:mo>-</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:msup>
                <m:mfenced separators="" open="(" close=")">
                  <m:msup>
                    <m:mi>C</m:mi>
                    <m:mrow>
                      <m:mo>-</m:mo>
                      <m:mi>T</m:mi>
                    </m:mrow>
                  </m:msup>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mi>K</m:mi>
                    <m:mi>c</m:mi>
                    <m:mo>-</m:mo>
                    <m:mi>G</m:mi>
                    <m:mi>d</m:mi>
                  </m:mfenced>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2271065">and use a numerical solver. We feed into Matlab's ode45
 to compute our solution over time given any initial condition.</para>
          <para id="id2271078">To simulate a smooth initial ripple, I coded in a 3-point Gaussian as the initial displacement to a single node when the user chooses to pluck the web at that specific node. Plucking multiple nodes sums the displacement up over each node, so that any overlap of the Gaussian initial condition between two nodes is accounted for.</para>
        </section>
        <section id="uid30">
          <title>Solving the eigenvalue problem with FEM</title>
          <para id="id2271094">Once we're given the mass and stiffness matrices, it's easy to numerically solve for the eigenvalues. Writing our second order system with damping (<m:math><m:mrow><m:mi>M</m:mi><m:msup><m:mi>c</m:mi><m:mrow><m:mo>'</m:mo><m:mo>'</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mi>K</m:mi><m:mi>c</m:mi><m:mo>-</m:mo><m:mi>G</m:mi><m:msup><m:mi>c</m:mi><m:mo>'</m:mo></m:msup></m:mrow></m:math>) as a linear system, we can solve for our eigenvalues by solving the system</para>
          <equation id="id2271142">
            <m:math mode="display">
              <m:mrow>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mi>I</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mi>K</m:mi>
                        </m:mrow>
                      </m:mtd>
                      <m:mtd>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mi>G</m:mi>
                        </m:mrow>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>u</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>v</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mo>=</m:mo>
                <m:mi>λ</m:mi>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>I</m:mi>
                      </m:mtd>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mn>0</m:mn>
                      </m:mtd>
                      <m:mtd>
                        <m:mi>M</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>u</m:mi>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:mi>v</m:mi>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
              </m:mrow>
            </m:math>
          </equation>
          <para id="id2271242">This is typically done using eig(A,B)
 in Matlab to solve this generalized eigenvalue problem, where <m:math><m:mrow><m:mi>A</m:mi><m:mo>,</m:mo><m:mi>B</m:mi></m:mrow></m:math> are, respectively, the left and right hand matrices in the above equation. However, a comparison of the FEM eigenvalues of a simple string in <link target-id="uid31"/> to the closed form solutions yields a large discrepancy for larger magnitude eigenvalues.</para>
          <figure id="uid31" orient="horizontal">
            <media id="idp1504224" alt=""><image src="../../media/FEMeigs.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/FEMeigs.eps" mime-type="application/postscript" print-width=".5"/></media>
            <caption>Comparison of FEM eigenvalue approximations to closed form solutions.</caption>
          </figure>
          <para id="id2271291">This behavior is typical of finite element discretizations; given the non-smooth nature of our basis functions, it is difficult to accurately approximate high-frequency eigenfunctions, and typically, only about <m:math><m:mrow><m:mn>10</m:mn><m:mo>-</m:mo><m:mn>15</m:mn><m:mo>%</m:mo></m:mrow></m:math> of the smallest approximated eigenvalues from FEM tend to be accurate. In order to compensate for this inaccuracy as much as possible, we try to find the few smallest eigenvalues of our system by finding the largest eigenvalues of the inverse of the system (which is arrived at from algebraic manipulation and similarity transforms) and then inverting those values. The eigs
 package in Matlab is suited perfectly for that; eigs
 can quickly compute the few smallest or largest eigenvalues of a large matrix where traditional eigensolvers typically fail due to high algorithmic complexity costs.</para>
        </section>
      </section>
      <section id="uid32">
        <title>Other approaches</title>
        <para id="id2271343">Since the finite element method does a poor job of representing higher frequency modes, work has been done by Dr. Embree and Jeremy Morell in implementing a similar generalized spectral discretization using Chebyshev polynomials, which proved much more accurate in describing eigenmodes corresponding to larger magnitude eigenvalues.</para>
      </section>
    </section>
    <section id="uid33">
      <title>Interpretation of results</title>
      <para id="id2271360">In this section, we examine the eigenvalues of networks computed from our finite element discretization. While analysis of these values turns out to be difficult, we examine closed form solutions for a similar eigenvalue problem on networks from a paper by Joachim Von Below <link target-id="bid2"/>.</para>
      <section id="uid34">
        <title>Numerical results</title>
        <para id="id2271380">Unlike our original wave equation <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mrow><m:mi>x</m:mi><m:mi>x</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:msub><m:mi>u</m:mi><m:mrow><m:mi>t</m:mi><m:mi>t</m:mi></m:mrow></m:msub></m:mrow></m:math>, our networks of strings are allowed three-dimensional freedom of motion. We can apply our network wave equation to a single string</para>
        <equation id="id2271419">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mrow>
                  <m:mi>x</m:mi>
                  <m:mi>x</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mi>P</m:mi>
              <m:msub>
                <m:mi>u</m:mi>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:msub>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2271454">where <m:math><m:mi>v</m:mi></m:math> is the unit vector specifying orientation of our string and <m:math><m:mrow><m:mi>P</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>[</m:mo><m:mrow><m:mo>(</m:mo><m:mi>s</m:mi><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mi>I</m:mi><m:mo>-</m:mo><m:mi>v</m:mi><m:msup><m:mi>v</m:mi><m:mi>T</m:mi></m:msup><m:mo>]</m:mo></m:mrow></m:math>. Assume without loss of generality that <m:math><m:mrow><m:mi>v</m:mi><m:mo>=</m:mo><m:mover accent="true"><m:mi>k</m:mi><m:mo>→</m:mo></m:mover><m:mo>=</m:mo><m:msup><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>]</m:mo></m:mrow><m:mi>T</m:mi></m:msup></m:mrow></m:math> and that <m:math><m:mrow><m:mi>k</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, <m:math><m:mrow><m:mi>s</m:mi><m:mo>=</m:mo><m:mn>2</m:mn></m:mrow></m:math>. Then <m:math><m:mi>P</m:mi></m:math> is simply a diagonal matrix and our equation <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mrow><m:mi>x</m:mi><m:mi>x</m:mi></m:mrow></m:msub><m:mo>=</m:mo><m:mi>P</m:mi><m:msub><m:mi>u</m:mi><m:mrow><m:mi>t</m:mi><m:mi>t</m:mi></m:mrow></m:msub></m:mrow></m:math> becomes</para>
        <equation id="id2271631">
          <m:math mode="display">
            <m:mrow>
              <m:msub>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>u</m:mi>
                          <m:mi>i</m:mi>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>u</m:mi>
                          <m:mi>j</m:mi>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>u</m:mi>
                          <m:mi>k</m:mi>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mrow>
                  <m:mi>t</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
                <m:mtable>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>1</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                  </m:mtr>
                  <m:mtr>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>0</m:mn>
                    </m:mtd>
                    <m:mtd>
                      <m:mn>2</m:mn>
                    </m:mtd>
                  </m:mtr>
                </m:mtable>
              </m:mfenced>
              <m:msub>
                <m:mfenced separators="" open="[" close="]">
                  <m:mtable>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>u</m:mi>
                          <m:mi>i</m:mi>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>u</m:mi>
                          <m:mi>j</m:mi>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                    <m:mtr>
                      <m:mtd>
                        <m:msub>
                          <m:mi>u</m:mi>
                          <m:mi>k</m:mi>
                        </m:msub>
                      </m:mtd>
                    </m:mtr>
                  </m:mtable>
                </m:mfenced>
                <m:mrow>
                  <m:mi>x</m:mi>
                  <m:mi>x</m:mi>
                </m:mrow>
              </m:msub>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2271774">where <m:math><m:mrow><m:msub><m:mi>u</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>u</m:mi><m:mi>j</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>u</m:mi><m:mi>k</m:mi></m:msub></m:mrow></m:math> are the the displacements of our string in the <m:math><m:mrow><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>,</m:mo><m:mi>k</m:mi></m:mrow></m:math> directions. Since each of the equations is independent of the others, we can solve for the eigenvalues and eigenfunctions of each one-dimensional wave equation separately</para>
        <equation id="id2271837">
          <m:math mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msubsup>
                      <m:mi>λ</m:mi>
                      <m:mi>i</m:mi>
                      <m:mn>2</m:mn>
                    </m:msubsup>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mfrac>
                    <m:mrow>
                      <m:msup>
                        <m:mi>∂</m:mi>
                        <m:mn>2</m:mn>
                      </m:msup>
                      <m:msub>
                        <m:mi>u</m:mi>
                        <m:mi>i</m:mi>
                      </m:msub>
                    </m:mrow>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msup>
                        <m:mi>x</m:mi>
                        <m:mn>2</m:mn>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msubsup>
                      <m:mi>λ</m:mi>
                      <m:mi>j</m:mi>
                      <m:mn>2</m:mn>
                    </m:msubsup>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mfrac>
                    <m:mrow>
                      <m:msup>
                        <m:mi>∂</m:mi>
                        <m:mn>2</m:mn>
                      </m:msup>
                      <m:msub>
                        <m:mi>u</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msup>
                        <m:mi>x</m:mi>
                        <m:mn>2</m:mn>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mn>2</m:mn>
                    <m:msubsup>
                      <m:mi>λ</m:mi>
                      <m:mi>k</m:mi>
                      <m:mn>2</m:mn>
                    </m:msubsup>
                    <m:msub>
                      <m:mi>u</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mfrac>
                    <m:mrow>
                      <m:msup>
                        <m:mi>∂</m:mi>
                        <m:mn>2</m:mn>
                      </m:msup>
                      <m:msub>
                        <m:mi>u</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                    </m:mrow>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msup>
                        <m:mi>x</m:mi>
                        <m:mn>2</m:mn>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id2272030">Then, if <m:math><m:mi>λ</m:mi></m:math> is an eigenvalue of our one-dimensional wave equation, the eigenvalues <m:math><m:mrow><m:msub><m:mi>λ</m:mi><m:mi>i</m:mi></m:msub><m:mo>,</m:mo><m:msub><m:mi>λ</m:mi><m:mi>j</m:mi></m:msub></m:mrow></m:math> and <m:math><m:msub><m:mi>λ</m:mi><m:mi>k</m:mi></m:msub></m:math> for the three dimensional wave equation are</para>
        <equation id="id2272088">
          <m:math mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:msub>
                    <m:mi>λ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>λ</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:msub>
                    <m:mi>λ</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>λ</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:msub>
                    <m:mi>λ</m:mi>
                    <m:mi>k</m:mi>
                  </m:msub>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msqrt>
                      <m:mn>2</m:mn>
                    </m:msqrt>
                    <m:mi>λ</m:mi>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id2272167">We can see this captured in Figures <link target-id="uid35"/> and <link target-id="uid36"/> - the eigenvalues of our discretization are the interleaved eigenvalues of three one dimensional wave equations. For general orientations, the result is the same.</para>
        <figure id="uid35" orient="horizontal">
          <media id="idp4714512" alt=""><image src="../../media/threedimeigs.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/threedimeigs.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Computed eigenvalues of the three-dimensional wave equation.</caption>
        </figure>
        <figure id="uid36" orient="horizontal">
          <media id="idp4376384" alt=""><image src="../../media/simpleeigs3.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/simpleeigs3.eps" mime-type="application/postscript" print-width=".45"/></media>
          <caption>Closed-form eigenvalues of the three-dimensional wave equation.</caption>
        </figure>
        <para id="id2272210">We can still trace out the linear progression of the eigenvalues here. However, the eigenvalues of a network of strings turn out to be far more interesting and unpredictable.</para>
        <para id="id2272216"><link target-id="uid38"/> presents the first few eigenvalues of a Y-shaped network of strings, similar to our tritar mentioned previously. Even among simple webs such as the tritar, the pattern of the progression of eigenvalues is not easily deduced.</para>
        <figure id="uid37" orient="horizontal">
          <media id="idp6608640" alt=""><image src="../../media/tritareigs.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/tritareigs.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Eigenvalues of a tritar</caption>
        </figure>
        <figure id="uid38" orient="horizontal">
          <media id="idp2952720" alt=""><image src="../../media/serpeigs.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/serpeigs.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Eigenvalues of a more complex network.</caption>
        </figure>
        <para id="id2272253">We can observe a few parts at which the eigenvalue behavior mimics the three dimensional single string. At values around <m:math><m:mrow><m:mn>1</m:mn><m:mo>.</m:mo><m:mn>5</m:mn><m:mi>i</m:mi></m:mrow></m:math> and <m:math><m:mrow><m:mn>3</m:mn><m:mi>i</m:mi></m:mrow></m:math>, there are double eigenvalues reminiscent of our double eigenvalues in <link target-id="uid36"/>, but the pattern of the rest of the eigenvalues is much less coherent.</para>
        <figure id="uid39" orient="horizontal">
          <media id="idp6448224" alt=""><image src="../../media/triteig5.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/triteig5.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 5</caption>
        </figure>
        <figure id="uid40" orient="horizontal">
          <media id="idp5102192" alt=""><image src="../../media/triteig10.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/triteig10.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 10</caption>
        </figure>
        <figure id="uid41" orient="horizontal">
          <media id="idm1915552" alt=""><image src="../../media/triteig11.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/triteig11.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 11</caption>
        </figure>
        <figure id="uid42" orient="horizontal">
          <media id="idp3682880" alt=""><image src="../../media/triteig12.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/triteig12.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 12</caption>
        </figure>
        <para id="id2272344">Figures <link target-id="uid43"/> to <link target-id="uid46"/> are FEM calculations of several eigenmodes of a more complex network. Note that as the number of legs and connections increase, the number of degrees of freedom for the movement of each leg (and thus the number of possible eigenmodes of the network) should increase as well. The eigenvalues for the more complex network exhibit a similarly nonlinear pattern in the progression of the eigenvalues of the tritar.</para>
        <figure id="uid43" orient="horizontal">
          <media id="idp7479872" alt=""><image src="../../media/serpeig5.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/serpeig5.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 5</caption>
        </figure>
        <figure id="uid44" orient="horizontal">
          <media id="idp6723856" alt=""><image src="../../media/serpeig9.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/serpeig9.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 9</caption>
        </figure>
        <figure id="uid45" orient="horizontal">
          <media id="idp4153952" alt=""><image src="../../media/serpeig10.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/serpeig10.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 10</caption>
        </figure>
        <figure id="uid46" orient="horizontal">
          <media id="idm2809760" alt=""><image src="../../media/serpeig12.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/serpeig12.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>Mode 12</caption>
        </figure>
      </section>
      <section id="uid47">
        <title>Closed form solutions</title>
        <para id="id2272420">To better understand the nonlinear progression of our eigenvalues, we seek out closed form solutions for the eigenvalues of networks. Joachim Von Below's provides one such solution in his examination of networks of strings in “A Characteristic Equation Associated to an Eigenvalue Problem on <m:math><m:msup><m:mi>c</m:mi><m:mn>2</m:mn></m:msup></m:math>-Networks", <emphasis>Linear Algebra and its Applications</emphasis>, Volume 71 (1985), p309-325.</para>
        <para id="id2272455">While his paper focuses on the heat equation on networks, given Neumann boundary conditions instead of Dirichlet, the eigenvalues of the heat equation are given to be constant <m:math><m:mi>μ</m:mi></m:math> such that</para>
        <equation id="id2272470">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>u</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msup>
                    <m:mi>x</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
              <m:mo>=</m:mo>
              <m:mi>μ</m:mi>
              <m:mi>u</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2272511">Since <m:math><m:mi>μ</m:mi></m:math> has to be less than or equal to zero in order for a solution to the heat equation, the eigenvalues of the heat equation are the squares of the eigenvalues of the wave equation</para>
        <equation id="id2272529">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mi>u</m:mi>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msup>
                    <m:mi>x</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>λ</m:mi>
                <m:mn>2</m:mn>
              </m:msup>
              <m:mi>u</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2272575">Therefore, taking the square roots of the eigenvalues <m:math><m:mi>μ</m:mi></m:math>, we can recover the eigenvalues of the wave equation on our network. For the rest of our stated examples, the eigenvalues mentioned are assumed to be eigenvalues of the wave equation.</para>
        <para id="id2272594">Von Below studies the network heat equation with Neumann conditions at the endpoints</para>
        <equation id="id2272598">
          <m:math mode="display">
            <m:mrow>
              <m:mfrac>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:mi>t</m:mi>
                </m:mrow>
              </m:mfrac>
              <m:mo>=</m:mo>
              <m:msub>
                <m:mi>a</m:mi>
                <m:mi>j</m:mi>
              </m:msub>
              <m:mfrac>
                <m:mrow>
                  <m:msup>
                    <m:mi>∂</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:msub>
                    <m:mi>u</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
                <m:mrow>
                  <m:mi>∂</m:mi>
                  <m:msubsup>
                    <m:mi>x</m:mi>
                    <m:mi>j</m:mi>
                    <m:mn>2</m:mn>
                  </m:msubsup>
                </m:mrow>
              </m:mfrac>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id2272669">where <m:math><m:msub><m:mi>u</m:mi><m:mi>j</m:mi></m:msub></m:math> is the temperature of the <m:math><m:mi>j</m:mi></m:math>th edge, <m:math><m:msub><m:mi>a</m:mi><m:mi>j</m:mi></m:msub></m:math> is the positive diffusion coefficient of the <m:math><m:mi>j</m:mi></m:math>th edge, and <m:math><m:mrow><m:msub><m:mi>x</m:mi><m:mi>j</m:mi></m:msub><m:mo>∈</m:mo><m:mrow><m:mo>[</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:msub><m:mi>ℓ</m:mi><m:mi>j</m:mi></m:msub><m:mo>]</m:mo></m:mrow></m:mrow></m:math> is position on the <m:math><m:mi>j</m:mi></m:math>th edge, which has length <m:math><m:msub><m:mi>ℓ</m:mi><m:mi>j</m:mi></m:msub></m:math>. The notation is the same as the notation with which the network wave equation was described.</para>
        <para id="id2272784">By defining simply a set of nodes and connections between them, Von Below calculates the eigenvalues and eigenmodes of a network with the help of spectral graph theory (a study of the connections between a graph and the eigenvalues of its adjacency matrix). The eigenvalues of the heat equation on networks of strings progress according to several different patterns, some of which are common to every network, some of which are network-specific and dependent on the eigenvalues of the network graph's row-normalized adjacency matrix.</para>
        <para id="id2272796">For nonspecific parameter values, the best we can hope to do is to solve a transcendental equation for our eigenvalues. For specific parameter values, such as when <m:math><m:mrow><m:msub><m:mi>a</m:mi><m:mi>j</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mi>ℓ</m:mi><m:mi>j</m:mi><m:mn>2</m:mn></m:msubsup></m:mrow></m:math>, we can solve analytically for both the eigenfunctions and eigenvalues of the heat equation, breaking both down into cases. There are, in general, 5 total classes into which eigenpairs of the heat equation on a network can be organized, with each network having at most 4 classes applicable to it.</para>
        <figure id="uid48" orient="horizontal">
          <media id="idp4638816" alt=""><image src="../../media/Teigssort.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/Teigssort.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>The tritar's eigenvalues sorted by cases</caption>
        </figure>
        <figure id="uid49" orient="horizontal">
          <media id="idp5411856" alt=""><image src="../../media/Teigs.png" mime-type="image/png" width="491"/><image for="pdf" src="../../media/Teigs.eps" mime-type="application/postscript" print-width=".5"/></media>
          <caption>The tritar's eigenvalues sorted by magnitude. These eigenvalues of the tritar are calculated via Von Below's methods. For each eigenvalue case, there exist an infinite number of eigenvalues</caption>
        </figure>
        <para id="id2272863">For each one of these classes mentioned, there is an infinite number of eigenvalues associated with it. Organizing the progression by <m:math><m:mi>k</m:mi></m:math> instead of by magnitude gives more insight into the nonlinear progression of our network eigenvalues - there is a clear bifurcating/splitting patten of the eigenvalues as <m:math><m:mi>k</m:mi></m:math> increases. As the progression of eigenvalues splits into two separate patterns, each pattern is linear with different rates.</para>
        <para id="id2272893">The fundamental difference here is that the eigenvalues for the one dimensional transverse network wave equation progress with two different rates. While there are two distinct sets of eigenvalues for our <emphasis>three dimensional</emphasis> string, to have eigenvalues progressing at different rates for <emphasis>one dimensional</emphasis> transverse string motion is atypical. This isn't a complete explanation for the irregular progression of the eigenvalues for the three dimensional wave equation; however, it does offer some clues as to the nonlinear ordering of those eigenvalues.</para>
      </section>
    </section>
    <section id="uid50">
      <title>Acknowledgments</title>
      <para id="id2272923">Thanks to Jeremy Morell, whose work I built upon, as well as Robert Likamwa, who helped nail down a lot of details concerning visualization and graphics. Thanks to Dr. Cox and Dr. Embree for their guidance their trust that I could actually do something with the project they gave me.</para>
      <para id="id2272931">This work was partially supported by NSF DMS Grant 0240058</para>
    </section>
  </content>
  <bib:file>
    <bib:entry id="bid0">
      <bib:book>
<!--required fields-->
        <bib:author>Antman, Stuart</bib:author>
        <bib:title>Nonlinear Problems of Elasticity (Applied Mathematical Sciences)</bib:title>
        <bib:publisher>Springer</bib:publisher>
        <bib:year>2005</bib:year>
<!--optional fields-->
        <bib:volume/>
        <bib:series/>
        <bib:address/>
        <bib:edition>2nd edition</bib:edition>
        <bib:month/>
        <bib:note/>
      </bib:book>
    </bib:entry>
    <bib:entry id="bid2">
      <bib:article>
<!--required fields-->
        <bib:author>Below, Joachim Von</bib:author>
        <bib:title>A Characteristic Equation Associated to an Eigenvalue Problem on c2 -Networks</bib:title>
        <bib:journal>Linear Algebra and its Applications</bib:journal>
        <bib:year>1985</bib:year>
<!--optional fields-->
        <bib:volume>71</bib:volume>
        <bib:number/>
        <bib:pages>309-325</bib:pages>
        <bib:month/>
        <bib:note/>
      </bib:article>
    </bib:entry>
    <bib:entry id="bid1">
      <bib:article>
<!--required fields-->
        <bib:author>Schmidt, E. J. P. Georg</bib:author>
        <bib:title>On the Modelling and Exact Controllability of Networks of Vibrating Strings</bib:title>
        <bib:journal>SICON</bib:journal>
        <bib:year>1992</bib:year>
<!--optional fields-->
        <bib:volume>30</bib:volume>
        <bib:number/>
        <bib:pages>229-245</bib:pages>
        <bib:month/>
        <bib:note/>
      </bib:article>
    </bib:entry>
  </bib:file>
</document>